<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Innov AI Tienda ‚Äî Tienda</title>
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <meta name="description" content="Explora Innov AI Tienda. Servicios digitales con entrega inmediata y soporte 24/7 por WhatsApp." />
  <meta name="keywords" content="Innov AI Tienda, tienda, servicios digitales, Per√∫, ChatGPT Plus, Gemini Pro, CapCut Pro, Perplexity, Canva, Autodesk, Netflix, Disney, Max, Prime Video, ViX, IPTV, Crunchyroll, Surfshark" />

  <!-- Favicon -->
  <link href="img/favicon.ico" rel="icon" />

  <!-- Favicon -->
  <link
    rel="icon"
    href="https://scontent-lga3-1.xx.fbcdn.net/v/t39.30808-6/615837823_122108019525185356_8176358403674802319_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=7tEmsLyO4TMQ7kNvwGfRNY0&_nc_oc=AdlfbnpxuiqhgqJxBG38AtVd7x38Ti8Ew-hs0JrWo4f5M0W6I-vWy2OJuI5Uc8i4h8w&_nc_zt=23&_nc_ht=scontent-lga3-1.xx&_nc_gid=l7gJgstSbBRAp3umgmGmbA&oh=00_AfoFO9c2Wu9POry19NovrQLkBGmpXfEyFCWnVMrMPHzXeA&oe=696C2D63"
  />

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Comic+Neue:wght@400;700&family=Bangers&display=swap"
    rel="stylesheet"
  />

  <!-- Font Awesome -->
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
    rel="stylesheet"
  />

  <!-- Libraries Stylesheet -->
  <link href="lib/animate/animate.min.css" rel="stylesheet" />
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/style.css" rel="stylesheet" />


  <style>
    :root{
      --brand-primary:#0d6efd;
      --brand-secondary:#6c757d;

      /* offsets para sticky (depende de tu header sticky) */
      --sticky-offset: 110px;

      /* WhatsApp FABs */
      --wa-size:64px;
      --wa-bg:#25D366;
      --wa-fg:#fff;
      --wa-shadow:0 10px 22px rgba(0,0,0,.28);
      --wa-attention:3.2s;

      /* Fly-to-cart */
      --trail-c1:#ff0040;
      --trail-c2:#00e5ff;
      --trail-c3:#7cff00;
      --fly-duration:1050ms;
      --trail-duration:650ms;

      /* Toast */
      --toast-bg:rgba(0,0,0,.86);
      --toast-fg:#fff;
    }
    @media (min-width: 992px){
      :root{ --sticky-offset: 180px; }
    }
    @media (prefers-reduced-motion: reduce){
      :root{ --fly-duration:0ms; --trail-duration:0ms; --wa-attention:0s; }
      *{ animation-duration:.01ms !important; animation-iteration-count:1 !important; transition-duration:.01ms !important; scroll-behavior:auto !important; }
    }

    /* Header pegado */
    .site-header.sticky-top{ z-index:1045; box-shadow:0 2px 8px rgba(0,0,0,.15); }

    /* Comic skin */
    body{
      font-family:'Comic Neue','Roboto',sans-serif;
      background:
        radial-gradient(circle at 10px 10px, rgba(0,0,0,.04) 2px, transparent 2.2px) 0 0/22px 22px,
        #fff;
    }
    h1,h2,h3,.h1,.h2,.h3{
      font-family:'Bangers','Comic Neue',cursive;
      letter-spacing:.6px;
    }
    .btn, .custom-select, .form-control{ border-width:2px; }
    .btn{ box-shadow:3px 3px 0 rgba(0,0,0,.20); }
    .btn:active{ transform:translate(2px,2px); box-shadow:1px 1px 0 rgba(0,0,0,.20); }
    .section-title > span{ box-shadow:inset 0 -2px 0 var(--brand-primary); }

    /* Sidebar sticky (quieto) */
    .shop-sidebar{ align-self:flex-start; }
    .shop-sidebar-sticky{
      position: sticky;
      top: calc(var(--sticky-offset) + 10px);
      max-height: calc(100vh - (var(--sticky-offset) + 30px));
      overflow:auto;
      padding-right:8px;
    }
    .shop-sidebar-sticky::-webkit-scrollbar{ width:10px; }
    .shop-sidebar-sticky::-webkit-scrollbar-thumb{ background:rgba(255,255,255,.0); border-radius:10px; }
    .shop-sidebar-sticky:hover::-webkit-scrollbar-thumb{ background:rgba(0,0,0,.18); }
    @media (max-width: 991.98px){
      .shop-sidebar-sticky{
        position: static;
        top: auto;
        max-height: none;
        overflow: visible;
        padding-right: 0;
      }
    }

    /* Toolbar sticky (t√≠tulo + ordenar) */
    .shop-toolbar{
      position: sticky;
      top: calc(var(--sticky-offset) + 10px);
      z-index: 1030;
      background: rgba(255,255,255,.92);
      backdrop-filter: blur(6px);
      border: 2px solid rgba(0,0,0,.08);
      border-radius: 14px;
      padding: .6rem .75rem;
      box-shadow: 6px 6px 0 rgba(0,0,0,.07);
      margin-bottom: 1rem;
    }
    @media (max-width: 991.98px){
      .shop-toolbar{
        position: static;
        top: auto;
        backdrop-filter: none;
        background: transparent;
        border: 0;
        box-shadow: none;
        padding: 0;
        margin-bottom: .75rem;
      }
    }

    /* Cards m√°s peque√±as */
    .product-item{
      border:2px solid rgba(0,0,0,.12);
      border-radius:14px;
      box-shadow:4px 4px 0 rgba(0,0,0,.10);
      overflow:hidden;
      transition:transform .18s ease;
      background:#fff;
    }
    .product-item:hover{ transform:translateY(-2px); }
    .product-item .text-center.py-4{ padding: .75rem .55rem !important; }
    .product-item a.h6{
      font-size: .95rem;
      line-height: 1.15;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      min-height: 2.2em;
    }

    /* IMAGEN DE PRODUCTO M√ÅS GRANDE */
    .product-img{
      background:linear-gradient(180deg,#fff,#f3f5f7);
      position:relative;
      display:flex;
      align-items:center;
      justify-content:center;
      padding:8px;
      min-height:180px;
    }

    .product-img img{
      width:100%;
      max-width:100%;
      height:auto;
      max-height:190px;
      object-fit:contain;
      background:transparent;
    }

    /* ‚ÄúNubes‚Äù (botones flotantes) m√°s bonitas */
    .product-action{
      position:absolute;
      left:0; right:0; bottom:10px;
      display:flex;
      justify-content:center;
      gap:8px;
      opacity:0;
      transform:translateY(10px);
      transition:opacity .18s ease, transform .18s ease;
      pointer-events:none;
    }
    .product-item:hover .product-action{
      opacity:1;
      transform:translateY(0);
      pointer-events:auto;
    }
    .product-action .btn-square{
      width:38px; height:38px;
      padding:0;
      border-radius:999px;
      display:inline-flex;
      align-items:center;
      justify-content:center;
      background:rgba(255,255,255,.96);
      border:2px solid rgba(0,0,0,.18);
      box-shadow:4px 4px 0 rgba(0,0,0,.14);
      transition:transform .12s, background .12s, color .12s;
    }
    .product-action .btn-square:hover{
      transform:translateY(-2px) rotate(-2deg);
      background:rgba(13,110,253,.18);
      color:#111;
    }
    .product-action .btn-detail{
      width:auto;
      padding:0 .8rem;
      border-radius:999px;
      gap:.45rem;
      font-weight:900;
    }
    .product-action .btn-detail span{
      font-size:12px;
      letter-spacing:.3px;
      text-transform:uppercase;
    }

    /* Estado disponible / cupo */
    .status-pill{
      position:absolute;
      top:10px; left:10px;
      padding:.25rem .55rem;
      border-radius:999px;
      font-weight:900;
      font-size:11px;
      border:2px solid rgba(0,0,0,.20);
      backdrop-filter:blur(4px);
      text-transform:uppercase;
      z-index:2;
      box-shadow:3px 3px 0 rgba(0,0,0,.10);
      letter-spacing:.3px;
      max-width: calc(100% - 20px);
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .status-pill.is-available{ background:rgba(25,135,84,.94); color:#fff; }
    .status-pill.is-unavailable{ background:rgba(255,59,48,.94); color:#fff; }

    .product-item.is-unavailable{ opacity:.70; }
    .product-item.is-unavailable .product-action .btn{ cursor:not-allowed; opacity:.7; }

    /* Categoria chip */
    .cat-chip{
      display:inline-flex;
      align-items:center;
      justify-content:center;
      padding:.12rem .5rem;
      border-radius:999px;
      border:2px solid rgba(0,0,0,.14);
      background:#fff;
      font-weight:900;
      font-size:10px;
      box-shadow:2px 2px 0 rgba(0,0,0,.08);
      margin-top:.35rem;
    }

    /* Etiqueta periodo (mensual / anual) */
    .period-note{
      font-size:12px;
      font-weight:900;
      color:rgba(0,0,0,.55);
      margin-top:.15rem;
    }

    /* Toast */
    .toast-mini{
      position:fixed; left:50%; bottom:90px; transform:translateX(-50%) translateY(20px);
      background:rgba(0,0,0,.86); color:#fff; padding:10px 14px; border-radius:12px;
      font-size:14px; z-index:1600; opacity:0; transition:opacity .2s, transform .2s;
      display:flex; align-items:center; gap:.5rem;
      max-width:min(92vw,520px);
      text-align:center;
      box-shadow:10px 10px 0 rgba(0,0,0,.18);
    }
    .toast-mini.show{ opacity:1; transform:translateX(-50%) translateY(0); }

    /* Modal mejoras */
    .meta-chips{ display:flex; flex-wrap:wrap; gap:.45rem; margin:.4rem 0 .6rem; }
    .meta-chip{
      display:inline-flex;
      align-items:center;
      gap:.4rem;
      padding:.22rem .55rem;
      border-radius:999px;
      background:#fff;
      border:2px solid rgba(0,0,0,.10);
      box-shadow:3px 3px 0 rgba(0,0,0,.08);
      font-weight:900;
      font-size:12px;
    }
    .meta-chip i{ opacity:.85; }

    .benefits-list{
      list-style:none;
      padding-left:0;
      margin:0;
    }
    .benefits-list li{
      display:flex;
      gap:.55rem;
      align-items:flex-start;
      padding:.38rem .5rem;
      border-radius:12px;
      border:2px solid rgba(0,0,0,.08);
      background:#fff;
      box-shadow:4px 4px 0 rgba(0,0,0,.06);
      margin-bottom:.5rem;
    }
    .benefits-list li i{
      margin-top:.15rem;
      color:#198754;
    }

    .extra-box{
      border:2px dashed rgba(0,0,0,.18);
      border-radius:14px;
      padding:.75rem;
      background:#fff;
      box-shadow:6px 6px 0 rgba(0,0,0,.06);
    }
    .extra-box details{
      border:2px solid rgba(0,0,0,.08);
      border-radius:12px;
      padding:.55rem .65rem;
      margin-bottom:.55rem;
      background:#f8f9fa;
    }
    .extra-box summary{
      cursor:pointer;
      font-weight:900;
      outline:none;
    }
    .extra-box .mini-grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:.35rem .75rem;
      margin-top:.5rem;
      font-size:13px;
    }
    @media (max-width: 575.98px){
      .extra-box .mini-grid{ grid-template-columns: 1fr; }
    }

    /* WhatsApp FABs */
    .whatsapp-fab,
    .whatsapp-fab-2{
      position:fixed; right:18px; width:var(--wa-size); height:var(--wa-size);
      border-radius:50%; background:var(--wa-bg); color:var(--wa-fg);
      display:flex; align-items:center; justify-content:center;
      box-shadow:var(--wa-shadow); z-index:1200; transition:transform .18s, filter .18s;
      isolation:isolate; animation:float-y 5.4s ease-in-out infinite;
    }
    .whatsapp-fab{ bottom:18px; }
    .whatsapp-fab-2{ bottom:98px; }
    .whatsapp-fab i, .whatsapp-fab-2 i{ font-size:calc(var(--wa-size)*.45); line-height:1; }
    .whatsapp-fab:hover, .whatsapp-fab-2:hover{ transform:translateY(-3px); filter:saturate(1.08) brightness(1.04); }
    .whatsapp-fab::after, .whatsapp-fab-2::after{
      content:""; position:absolute; inset:-10px; border-radius:inherit;
      box-shadow:0 0 0 0 rgba(37,211,102,.30);
      animation:wa-pulse var(--wa-attention) infinite ease-out; z-index:-1;
    }
    @keyframes wa-pulse{
      0%{ box-shadow:0 0 0 0 rgba(37,211,102,.33); }
      70%{ box-shadow:0 0 0 20px rgba(37,211,102,0); }
      100%{ box-shadow:0 0 0 0 rgba(37,211,102,0); }
    }
    .whatsapp-badge{
      position:absolute; top:-4px; right:-2px; min-width:18px; height:18px; padding:0 4px;
      border-radius:10px; background:#ff3b30; color:#fff; font-size:11px; font-weight:900;
      display:inline-flex; align-items:center; justify-content:center;
      box-shadow:0 2px 8px rgba(0,0,0,.25); animation:pulse 1.6s infinite;
    }
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.12)}100%{transform:scale(1)}}
    @keyframes float-y{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}

    /* Fly-to-cart */
    .trail{
      position:fixed; pointer-events:none; width:10px; height:10px; border-radius:50%;
      filter:blur(.5px) drop-shadow(0 0 8px currentColor);
      opacity:.9; animation:trailfade var(--trail-duration) ease-out forwards; z-index:1400;
    }
    @keyframes trailfade{ to{ transform:scale(.6); opacity:0; } }
    .fly-ghost{
      position:fixed; width:42px; height:42px; display:flex; align-items:center; justify-content:center;
      font-size:24px; border-radius:50%; background:#0b0b0b; color:#fff;
      box-shadow:0 8px 18px rgba(0,0,0,.25), inset 0 0 22px rgba(255,255,255,.07);
      z-index:1500; will-change:transform,opacity; overflow:hidden;
    }
    .fly-ghost.is-img{ background:#111; }
    .fly-ghost.is-img > img{ width:100%; height:100%; object-fit:cover; display:block; }

    /* Footer mejorado */
    .footer-wrap{
      background:
        radial-gradient(circle at 20% 0%, rgba(13,110,253,.22), transparent 55%),
        radial-gradient(circle at 85% 100%, rgba(37,211,102,.16), transparent 55%),
        #0f1115;
    }
    .footer-title{ font-family:'Bangers','Comic Neue',cursive; letter-spacing:.7px; }
    .footer-links a{ color: rgba(255,255,255,.70); text-decoration:none; }
    .footer-links a:hover{ color:#fff; text-decoration: underline; }
    .social-btn{
      width:44px; height:44px;
      display:inline-flex; align-items:center; justify-content:center;
      border-radius:12px;
      border:2px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      color:#fff;
      margin-right:.5rem;
      box-shadow:4px 4px 0 rgba(0,0,0,.35);
      transition:transform .15s, background .15s, border-color .15s;
    }
    .social-btn:hover{
      transform:translateY(-2px) rotate(-1deg);
      background:rgba(13,110,253,.22);
      border-color:rgba(255,255,255,.30);
      color:#fff;
      text-decoration:none;
    }
    .social-btn i{ font-size:18px; }
    .tiktok-svg{ width:18px; height:18px; fill: currentColor; display:block; }

    /* ================== MEJORAS M√ìVIL (SOLO UI) ================== */
    .filters-toggle{
      border:2px solid rgba(0,0,0,.12);
      box-shadow:4px 4px 0 rgba(0,0,0,.10);
      border-radius:14px;
      font-weight:900;
    }
    .filters-toggle i{ opacity:.9; }

    @media (max-width: 991.98px){
      .shop-sidebar .section-title{ margin-bottom:.5rem; }
      .shop-sidebar .bg-light.p-3.mb-30{
        padding:.75rem !important;
        margin-bottom:1rem !important;
        border-radius:14px;
        border:2px solid rgba(0,0,0,.08);
        box-shadow:4px 4px 0 rgba(0,0,0,.06);
      }
    }

    @media (max-width: 575.98px){
      .shop-sidebar .section-title > span{ font-size:.95rem; }
      .shop-sidebar small{ font-size:12px; }
      .shop-sidebar .btn-group-toggle .btn{ padding:.25rem .4rem; font-size:.78rem; }
      #minPrice, #maxPrice{ max-width:108px !important; }

      .product-img{
        min-height:150px;
        padding:6px;
      }
      .product-img img{
        max-height:170px;
      }

      .product-item a.h6{ font-size:.86rem; }
      .product-item .text-center.py-4{ padding:.6rem .45rem !important; }
      .cat-chip{ font-size:9px; }
      .period-note{ font-size:11px; }

      /* En m√≥vil (t√°ctil): acciones visibles sin hover */
      .product-action{
        opacity:1;
        transform:none;
        pointer-events:auto;
      }
      .product-action .btn-square{ width:34px; height:34px; }
      .product-action .btn-detail{ padding:0 .65rem; }
    }

    /* Modal m√°s c√≥modo en m√≥vil */
    @media (max-width: 575.98px){
      #productModal .modal-dialog{
        margin:.5rem;
        max-width:100%;
      }
      #productModal .modal-content{
        border-radius:16px;
      }
      #productModal .modal-body{
        max-height:calc(100vh - 110px);
        overflow-y:auto;
      }
    }

    /* Resaltar carrito (m√°s visible al finalizar fly-to-cart) */
    @keyframes cart-attn{
      0%{ transform:scale(1); box-shadow:0 0 0 0 rgba(13,110,253,0); }
      45%{ transform:scale(1.35); box-shadow:0 0 0 12px rgba(13,110,253,.22); }
      100%{ transform:scale(1); box-shadow:0 0 0 0 rgba(13,110,253,0); }
    }
    .cart-attn{
      animation: cart-attn 700ms ease-out;
      border-color: rgba(13,110,253,.75) !important;
    }

    /* Bot√≥n copiar link en modal */
    #modalCopyLink{
      border-width:2px;
      border-radius:999px;
      font-weight:900;
      box-shadow:3px 3px 0 rgba(0,0,0,.12);
    }
  </style>
</head>

<body>
  <!-- ===== HEADER PEGADO ===== -->
  <header class="site-header sticky-top">
    <!-- Topbar -->
    <div class="container-fluid">
      <div class="row bg-secondary py-1 px-xl-5">
        <div class="col-lg-6 d-none d-lg-block">
          <div class="d-inline-flex align-items-center h-100">
            <a class="text-body mr-3" href="acerca.html">Acerca de</a>
            <a class="text-body mr-3" href="contact.html">Contacto</a>
            <a class="text-body mr-3" href="ayuda.html">Ayuda</a>
            <a class="text-body mr-3" href="faq.html">Preguntas frecuentes</a>
          </div>
        </div>
        <div class="col-lg-6 text-center text-lg-right">
          <div class="d-inline-flex align-items-center">
            <!-- Moneda -->
            <div class="btn-group mx-2">
              <button id="currencyBtn" type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">Soles</button>
              <div class="dropdown-menu dropdown-menu-right">
                <button class="dropdown-item js-set-currency" data-currency="PEN" type="button">Soles</button>
                <button class="dropdown-item js-set-currency" data-currency="USD" type="button">USD</button>
              </div>
            </div>

            <div class="btn-group">
              <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">ES</button>
              <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="?lang=en">EN</a>
              </div>
            </div>
          </div>

          <div class="d-inline-flex align-items-center d-block d-lg-none">
            <a href="cart.html" class="btn px-0 ml-2 d-inline-flex align-items-center" aria-label="Carrito">
              <i class="fas fa-shopping-cart text-dark mr-1"></i>
              <span class="font-weight-bold mr-1">Carrito</span>
              <span id="headerCartBadgeSm" class="badge text-dark border border-dark rounded-circle" style="padding-bottom:2px;">0</span>
            </a>
          </div>
        </div>
      </div>

      <!-- Branding + search -->
      <div class="row align-items-center bg-light py-3 px-xl-5 d-none d-lg-flex">
        <div class="col-lg-4">
          <a href="index.html" class="text-decoration-none">
            <span class="h1 text-uppercase text-primary bg-dark px-2">INNOV</span>
            <span class="h1 text-uppercase text-dark bg-primary px-2 ml-n1">TIENDA</span>
          </a>
        </div>
        <div class="col-lg-4 col-6 text-left">
          <form action="buscar.html">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Buscar productos" aria-label="Buscar productos" />
              <div class="input-group-append">
                <button class="input-group-text bg-transparent text-primary" aria-label="Buscar" type="submit">
                  <i class="fa fa-search"></i>
                </button>
              </div>
            </div>
          </form>
        </div>
        <div class="col-lg-4 col-6 text-right">
          <p class="m-0">Servicio al cliente</p>
          <h5 class="m-0"><a href="tel:+51991564053" class="text-dark">+51 991564053</a></h5>
        </div>
      </div>
    </div>

    <!-- Navbar -->
    <div class="container-fluid bg-dark">
      <div class="row px-xl-5">
        <div class="col-lg-3 d-none d-lg-block">
          <a class="btn d-flex align-items-center justify-content-between bg-primary w-100" data-toggle="collapse" href="#navbar-vertical" style="height:65px;padding:0 30px;">
            <h6 class="text-dark m-0"><i class="fa fa-bars mr-2"></i>Categor√≠as</h6>
            <i class="fa fa-angle-down text-dark"></i>
          </a>
          <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 bg-light" id="navbar-vertical" style="width:calc(100% - 30px);z-index:999;">
            <div class="navbar-nav w-100">
              <a href="#" class="nav-item nav-link js-nav-cat" data-cat="ai"><i class="fas fa-robot mr-2"></i>IA</a>
              <a href="#" class="nav-item nav-link js-nav-cat" data-cat="streaming"><i class="fas fa-tv mr-2"></i>Streaming</a>
              <a href="#" class="nav-item nav-link js-nav-cat" data-cat="musica"><i class="fas fa-film mr-2"></i>Edici√≥n / Video</a>
              <a href="#" class="nav-item nav-link js-nav-cat" data-cat="otros"><i class="fas fa-cubes mr-2"></i>Herramientas</a>
            </div>
          </nav>
        </div>

        <div class="col-lg-9">
          <nav class="navbar navbar-expand-lg bg-dark navbar-dark py-3 py-lg-0 px-0">
            <a href="index.html" class="text-decoration-none d-block d-lg-none">
              <span class="h1 text-uppercase text-dark bg-light px-2">INNOV</span>
              <span class="h1 text-uppercase text-light bg-primary px-2 ml-n1">TIENDA</span>
            </a>
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
              <div class="navbar-nav mr-auto py-0">
                <a href="index.html" class="nav-item nav-link">Inicio</a>
                <a href="shop.html" class="nav-item nav-link active">Tienda</a>
                <a href="detail.html" class="nav-item nav-link">Detalle</a>
                <div class="nav-item dropdown">
                  <a href="#" class="nav-link dropdown-toggle" data-toggle="dropdown">P√°ginas <i class="fa fa-angle-down mt-1"></i></a>
                  <div class="dropdown-menu bg-primary rounded-0 border-0 m-0">
                    <a href="cart.html" class="dropdown-item">Carrito</a>
                    <a href="checkout.html" class="dropdown-item">Pagar</a>
                  </div>
                </div>
                <a href="contact.html" class="nav-item nav-link">Contacto</a>
              </div>

              <div class="navbar-nav ml-auto py-0 d-none d-lg-block">
                <a href="cart.html" class="btn px-0 ml-3 d-inline-flex align-items-center" aria-label="Carrito">
                  <i class="fas fa-shopping-cart text-primary mr-1"></i>
                  <span class="text-light font-weight-bold mr-1">Carrito</span>
                  <span id="headerCartBadge" class="badge text-secondary border border-secondary rounded-circle" style="padding-bottom:2px;">0</span>
                </a>
              </div>

            </div>
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- ===== /HEADER PEGADO ===== -->

  <!-- Breadcrumb -->
  <div class="container-fluid">
    <div class="row px-xl-5">
      <div class="col-12">
        <nav class="breadcrumb bg-light mb-30">
          <a class="breadcrumb-item text-dark" href="index.html">Inicio</a>
          <span class="breadcrumb-item active">Tienda</span>
        </nav>
      </div>
    </div>
  </div>

  <!-- Shop -->
  <div class="container-fluid">
    <div class="row px-xl-5">

      <!-- Sidebar sticky -->
      <aside class="col-lg-3 col-md-4 shop-sidebar">
        <div class="shop-sidebar-sticky">

          <!-- ‚úÖ Bot√≥n filtros (solo m√≥vil/tablet) -->
          <button id="filtersToggleBtn"
                  class="btn btn-primary btn-block d-lg-none mb-3 filters-toggle"
                  type="button"
                  data-toggle="collapse"
                  data-target="#filtersCollapse"
                  aria-expanded="false"
                  aria-controls="filtersCollapse">
            <i class="fa fa-filter mr-2"></i> Filtros
          </button>

          <!-- ‚úÖ Contenido colapsable en m√≥vil; siempre visible en desktop -->
          <div id="filtersCollapse" class="collapse d-lg-block">

            <h5 class="section-title position-relative text-uppercase mb-3">
              <span class="bg-secondary pr-3">Tipo de venta</span>
            </h5>
            <div class="bg-light p-3 mb-30">
              <div class="btn-group btn-group-toggle d-flex" data-toggle="buttons">
                <label id="modeRetailBtn" class="btn btn-sm btn-outline-dark active flex-fill">
                  <input type="radio" name="mode" value="retail" checked> Por menor
                </label>
                <label id="modeWholesaleBtn" class="btn btn-sm btn-outline-dark flex-fill">
                  <input type="radio" name="mode" value="wholesale"> Proveedores
                </label>
              </div>
              <small class="d-block mt-2 text-muted">‚ÄúProveedores‚Äù = cuentas completas / multiusuarios.</small>
            </div>

            <h5 class="section-title position-relative text-uppercase mb-3">
              <span class="bg-secondary pr-3">Rango de precio</span>
            </h5>
            <div class="bg-light p-3 mb-30">
              <div class="form-group mb-2">
                <label class="small mb-1" id="priceLabel">Rango</label>
                <div class="d-flex align-items-center">
                  <input id="minPrice" type="number" class="form-control form-control-sm mr-2" min="0" step="0.1" value="0" style="max-width:120px">
                  <span class="mx-1">‚Äì</span>
                  <input id="maxPrice" type="number" class="form-control form-control-sm ml-2" min="0" step="0.1" value="30" style="max-width:120px">
                </div>
              </div>
              <div class="d-flex">
                <button id="applyFilters" class="btn btn-sm btn-primary mr-2">Aplicar</button>
                <button id="clearFilters" class="btn btn-sm btn-outline-secondary">Limpiar</button>
              </div>
              <small class="d-block mt-2 text-muted">* Se adapta a moneda y modo</small>
            </div>

            <h5 class="section-title position-relative text-uppercase mb-3">
              <span class="bg-secondary pr-3">Categor√≠as</span>
            </h5>
            <div class="bg-light p-3 mb-30">
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input js-cat" id="fc-ai" value="ai" checked>
                <label class="custom-control-label" for="fc-ai">IA</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input js-cat" id="fc-stream" value="streaming" checked>
                <label class="custom-control-label" for="fc-stream">Streaming</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input js-cat" id="fc-music" value="musica" checked>
                <label class="custom-control-label" for="fc-music">Edici√≥n/Video</label>
              </div>
              <div class="custom-control custom-checkbox">
                <input type="checkbox" class="custom-control-input js-cat" id="fc-otros" value="otros" checked>
                <label class="custom-control-label" for="fc-otros">Herramientas</label>
              </div>
            </div>

            <div class="bg-light p-3 mb-30 small text-muted">
              <div><strong>Estado:</strong> por defecto ‚ÄúDisponible‚Äù (verde).</div>
              <div>Para poner rojo: <code>disponible:false</code> o <code>cupo:0</code>.</div>
            </div>

          </div>
        </div>
      </aside>

      <!-- Productos -->
      <main class="col-lg-9 col-md-8">
        <div class="shop-toolbar d-flex align-items-center justify-content-between">
          <h5 id="sectionTitle" class="mb-0">Productos</h5>
          <div class="d-flex align-items-center">
            <label class="mb-0 mr-2 small text-muted">Ordenar:</label>
            <select id="sortSelect" class="custom-select custom-select-sm" style="max-width:240px">
              <option value="relevance">Relevancia</option>
              <option value="price-asc">Precio: menor a mayor</option>
              <option value="price-desc">Precio: mayor a menor</option>
              <option value="name-asc">Nombre: A-Z</option>
              <option value="name-desc">Nombre: Z-A</option>
            </select>
          </div>
        </div>

        <div id="productsGrid" class="row pb-3"></div>

        <div class="col-12">
          <nav>
            <ul id="pagination" class="pagination justify-content-center"></ul>
          </nav>
        </div>
      </main>

    </div>
  </div>

  <!-- Footer (mejorado) -->
  <footer class="container-fluid footer-wrap text-secondary mt-5 pt-5">
    <div class="row px-xl-5 pt-4">
      <div class="col-lg-4 col-md-12 mb-5 pr-3 pr-xl-5">
        <h4 class="footer-title text-light mb-3">Innov AI Tienda</h4>
        <p class="mb-3" style="color: rgba(255,255,255,.72);">
          Servicios digitales con entrega r√°pida y soporte por WhatsApp.
        </p>

        <div class="p-3" style="background: rgba(255,255,255,.06); border:2px solid rgba(255,255,255,.10); border-radius:14px; box-shadow:6px 6px 0 rgba(0,0,0,.25);">
          <p class="mb-2" style="color: rgba(255,255,255,.72);"><i class="fa fa-map-marker-alt text-primary mr-2"></i>Lima ‚Äî San Isidro ‚Äî Per√∫</p>
          <p class="mb-2"><i class="fa fa-envelope text-primary mr-2"></i><a href="mailto:ainnov611@gmail.com" class="text-light">ainnov611@gmail.com</a></p>
          <p class="mb-0"><i class="fa fa-phone-alt text-primary mr-2"></i><a href="tel:+51991564053" class="text-light">+51 991564053</a></p>

          <hr style="border-color: rgba(255,255,255,.10);" />

          <div>
            <div class="small mb-2" style="color: rgba(255,255,255,.70); font-weight:900;">S√≠guenos</div>

            <a class="social-btn" href="https://www.facebook.com/profile.php?id=61585560703359" target="_blank" rel="noopener" aria-label="Facebook">
              <i class="fab fa-facebook-f"></i>
            </a>

            <a class="social-btn" href="https://www.instagram.com/innov_iaa/" target="_blank" rel="noopener" aria-label="Instagram">
              <i class="fab fa-instagram"></i>
            </a>

            <a class="social-btn" href="https://www.tiktok.com/@innoovia" target="_blank" rel="noopener" aria-label="TikTok">
              <!-- TikTok SVG (FA 5.10 no siempre incluye tiktok) -->
              <svg class="tiktok-svg" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M17.5 3c.6 2.7 2.6 4.9 5.2 5.6v3.4c-2.2 0-4.2-.7-5.9-2v6.3c0 4-3.2 7.2-7.2 7.2S2.4 20.3 2.4 16.3c0-4 3.2-7.2 7.2-7.2.4 0 .8 0 1.2.1v3.8c-.4-.2-.8-.3-1.2-.3-1.9 0-3.5 1.6-3.5 3.5s1.6 3.5 3.5 3.5 3.5-1.6 3.5-3.5V1.9h3.2c.1.4.2.7.3 1.1z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>

      <div class="col-lg-8 col-md-12">
        <div class="row">
          <div class="col-md-4 mb-5 footer-links">
            <h5 class="footer-title text-light mb-3">Compra r√°pida</h5>
            <div class="d-flex flex-column justify-content-start">
              <a class="mb-2" href="index.html"><i class="fa fa-angle-right mr-2"></i>Inicio</a>
              <a class="mb-2" href="shop.html"><i class="fa fa-angle-right mr-2"></i>Tienda</a>
              <a class="mb-2" href="cart.html"><i class="fa fa-angle-right mr-2"></i>Carrito</a>
              <a class="mb-2" href="checkout.html"><i class="fa fa-angle-right mr-2"></i>Pagar</a>
              <a href="contact.html"><i class="fa fa-angle-right mr-2"></i>Contacto</a>
            </div>
          </div>

          <div class="col-md-4 mb-5 footer-links">
            <h5 class="footer-title text-light mb-3">Soporte</h5>
            <div class="d-flex flex-column justify-content-start">
              <a class="mb-2" href="faq.html"><i class="fa fa-angle-right mr-2"></i>Preguntas frecuentes</a>
              <a class="mb-2" href="ayuda.html"><i class="fa fa-angle-right mr-2"></i>Ayuda</a>
              <a class="mb-2" href="contact.html"><i class="fa fa-angle-right mr-2"></i>Soporte</a>
            </div>
            <div class="mt-3 p-3" style="background: rgba(255,255,255,.06); border:2px dashed rgba(255,255,255,.16); border-radius:14px;">
              <div class="text-light" style="font-weight:900;">Entrega inmediata</div>
              <div style="color: rgba(255,255,255,.70);">Te atendemos r√°pido por WhatsApp.</div>
            </div>
          </div>

          <div class="col-md-4 mb-5">
            <h5 class="footer-title text-light mb-3">Bolet√≠n</h5>
            <p style="color: rgba(255,255,255,.70);">Recibe ofertas y novedades.</p>
            <form action="/suscribirse" method="post">
              <div class="input-group">
                <input type="email" class="form-control" placeholder="Tu correo" required />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="submit">Inscribirse</button>
                </div>
              </div>
            </form>

            <div class="mt-4 p-3" style="background: rgba(255,255,255,.06); border:2px solid rgba(255,255,255,.10); border-radius:14px;">
              <div class="small" style="color: rgba(255,255,255,.70);">
                <strong class="text-light">Tip:</strong> si vuelves del pago con <code class="text-light">?paid=1</code>, el carrito se limpia solo.
              </div>
            </div>
          </div>

        </div>
      </div>
    </div>

    <div class="row border-top mx-xl-5 py-4" style="border-color: rgba(256, 256, 256, .1) !important;">
      <div class="col-md-6 px-xl-0">
        <p class="mb-md-0 text-center text-md-left" style="color: rgba(255,255,255,.70);">
          &copy; <a class="text-primary" href="#">Innov AI Tienda</a>. Todos los derechos reservados.
        </p>
      </div>
      <div class="col-md-6 px-xl-0 text-center text-md-right">
        <img class="img-fluid" src="img/payments.png" alt="M√©todos de pago" />
      </div>
    </div>
  </footer>

  <!-- Back to Top -->
  <a href="#" class="btn btn-primary back-to-top" aria-label="Volver arriba"><i class="fa fa-angle-double-up"></i></a>

  <!-- WhatsApp FABs -->
  <a id="whatsappFab" class="whatsapp-fab" href="https://wa.me/51930264550?text=¬°Hola!%20üëã%20Vengo%20de%20su%20p√°gina%20y%20me%20gustar√≠a%20m√°s%20informaci√≥n%20sobre%20los%20servicios%20‚ú®" target="_blank" rel="noopener" aria-label="WhatsApp principal">
    <i class="fab fa-whatsapp"></i>
    <span id="whatsappBadge" class="whatsapp-badge" aria-hidden="true">1</span>
  </a>
  <a id="whatsappFab2" class="whatsapp-fab-2" href="https://wa.me/51991564053?text=¬°Hola!%20üëã%20Vengo%20de%20su%20p√°gina%20web%20y%20me%20gustar√≠a%20m√°s%20informaci√≥n%20üòä" target="_blank" rel="noopener" aria-label="WhatsApp secundario">
    <i class="fab fa-whatsapp"></i>
    <span id="whatsappBadge2" class="whatsapp-badge" aria-hidden="true">1</span>
  </a>

  <!-- Micro-toast -->
  <div id="toastMini" class="toast-mini" role="status" aria-live="polite" aria-atomic="true">
    <i class="fas fa-check-circle"></i>
    <span id="toastText">A√±adido al carrito</span>
  </div>

  <!-- Modal Detalle -->
  <div class="modal fade" id="productModal" tabindex="-1" role="dialog" aria-labelledby="productModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
      <div class="modal-content">
        <div class="modal-header flex-wrap">
          <h5 id="productModalLabel" class="modal-title mb-0 mr-2">Detalle del producto</h5>

          <div class="ml-auto d-flex align-items-center">
            <!-- Bot√≥n carrito dentro del modal -->
            <button id="modalCartBtn" type="button" class="btn btn-sm btn-dark mr-2">
              <i class="fas fa-shopping-cart"></i>
              Carrito
              <span id="modalCartQty" class="badge badge-light ml-1">0</span>
            </button>

            <!-- Bot√≥n copiar link -->
            <button id="modalCopyLink" type="button" class="btn btn-sm btn-outline-primary mr-2" aria-label="Copiar link del producto">
              <i class="fa fa-link"></i> Copiar link
            </button>

            <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
        </div>

        <div class="modal-body">
          <div class="row">
            <div class="col-md-5">
              <img id="modalImg" src="img/placeholder.jpg" alt="" class="img-fluid rounded mb-3">
              <div class="d-flex align-items-center justify-content-between">
                <div class="meta-chip"><i class="fa fa-tag"></i> <span id="modalPrice">S/ --</span></div>
                <div class="meta-chip"><i class="fa fa-signal"></i> <span id="modalStatus">Disponible</span></div>
              </div>
              <small id="modalUsd" class="text-muted d-block mt-1"></small>
              <div id="modalChips" class="meta-chips"></div>
            </div>

            <div class="col-md-7">
              <h5 id="modalTitle" class="mb-2"></h5>
              <p id="modalDesc" class="mb-3"></p>

              <div class="mb-3">
                <div class="font-weight-bold mb-2">‚úÖ Beneficios</div>
                <ul id="modalBenefits" class="benefits-list"></ul>
              </div>

              <div class="alert alert-light border">
                <strong>¬øPor qu√© conviene?</strong>
                <div id="modalWhy" class="mt-1"></div>
              </div>

              <div id="modalExtra" class="extra-box d-none"></div>

              <div class="d-flex flex-wrap mt-3">
                <button id="modalAdd" class="btn btn-outline-dark mr-2 mb-2"><i class="fa fa-shopping-cart"></i> A√±adir</button>
                <button id="modalBuy" class="btn btn-dark mb-2"><i class="fas fa-bolt"></i> Comprar ahora</button>
              </div>

              <small class="text-muted d-block mt-2">
                * Si el producto est√° en <strong>Consultar</strong>, el bot√≥n abre WhatsApp.
              </small>
            </div>
          </div>
        </div>

        <div class="modal-footer small text-muted">
          Cierra con la <strong>X</strong> o haciendo clic fuera del recuadro.
        </div>
      </div>
    </div>
  </div>

  <!-- JS libraries -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="js/main.js"></script>

  <script>
  (function(){
    /* ================== Config ================== */
    const FX = 3.70;              // 1 USD = 3.70 S/
    const PAGE_SIZE = 16;         // cards peque√±as

    const WA_PRIMARY   = '51930264550';
    const WA_SECONDARY = '51991564053';

    // Base para los links compartibles de productos (para WhatsApp / redes)
    // Ajusta el dominio si cambias de hosting:
    const SHARE_BASE = 'https://innovaistreming.vercel.app/p/';

    const SETTINGS = {
      currency: localStorage.getItem('innov_currency') || 'PEN',
      flyDurationMs: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--fly-duration')) || 1050,
      trailDurationMs: parseInt(getComputedStyle(document.documentElement).getPropertyValue('--trail-duration')) || 650,
      trailDensity: 26,
      trailSize: 10,
      useEmojiFirst: true,
      cartRedirectDelay: 350,
      toastTime: 1300
    };

    const state = {
      currency: SETTINGS.currency,
      mode: 'retail', // retail | wholesale
      page: 1,
      sort: 'relevance',
      cats: new Set(['ai','streaming','musica','otros']),
      min: 0,
      max: null
    };

    /* ================== Utils ================== */
    function esc(s){
      return String(s ?? '')
        .replaceAll('&','&amp;')
        .replaceAll('<','&lt;')
        .replaceAll('>','&gt;')
        .replaceAll('"','&quot;');
    }
    function normalizeUrl(u){
      if(!u) return '';
      u = String(u).trim();
      if(!u) return '';
      if(!/^https?:\/\//i.test(u)) u = 'https://' + u;
      return u;
    }

    /* ================== Deep links por producto ================== */
    function buildProductLink(id){
      try{
        const url = new URL(window.location.href);
        url.hash = 'p=' + encodeURIComponent(id);
        return url.toString();
      }catch(e){
        const base = window.location.href.split('#')[0];
        return base + '#p=' + encodeURIComponent(id);
      }
    }
    function setProductHash(id){
      try{
        const url = new URL(window.location.href);
        url.hash = 'p=' + encodeURIComponent(id);
        history.replaceState(null, '', url.toString());
      }catch(e){
        window.location.hash = 'p=' + encodeURIComponent(id);
      }
    }
    function getProductFromHash(){
      const raw = String(window.location.hash || '').replace(/^#/, '');
      if(!raw) return null;
      const params = new URLSearchParams(raw);
      return params.get('p');
    }
    async function copyToClipboard(text){
      try{
        if(navigator.clipboard && window.isSecureContext){
          await navigator.clipboard.writeText(text);
          return true;
        }
      }catch(e){}
      try{
        const ta = document.createElement('textarea');
        ta.value = text;
        ta.setAttribute('readonly','');
        ta.style.position = 'fixed';
        ta.style.top = '-9999px';
        ta.style.left = '-9999px';
        document.body.appendChild(ta);
        ta.select();
        document.execCommand('copy');
        ta.remove();
        return true;
      }catch(e){
        return false;
      }
    }

    /* ================== Carrito (NO se pega) ================== */
    const CART_KEY = 'innov_cart_v1';
    const CART_STORE = sessionStorage; // IMPORTANT: no se queda guardado

    const readCart = () => { try { return JSON.parse(CART_STORE.getItem(CART_KEY) || '[]'); } catch(e){ return []; } };
    const writeCart = (arr) => CART_STORE.setItem(CART_KEY, JSON.stringify(arr));

    window.Cart = window.Cart || {
      add: (item) => {
        const items = readCart();
        const idx = items.findIndex(i => i.id === item.id);
        if(idx>-1){ items[idx].qty += (item.qty||1); }
        else { items.push({ id:item.id, nombre:item.nombre, precio:Number(item.precio||0), imagen:item.imagen||'', qty:item.qty||1 }); }
        writeCart(items);
        return items;
      },
      items: ()=> readCart(),
      count: ()=> readCart().reduce((a,b)=>a+b.qty,0),
      clear: ()=> { CART_STORE.removeItem(CART_KEY); }
    };

    function syncHeaderBadges(){
      const c = Cart.count();
      const b1 = document.getElementById('headerCartBadge');
      const b2 = document.getElementById('headerCartBadgeSm');
      [b1,b2].forEach(b=>{ if(b) b.textContent = c; });

      const badgeModalCart = document.getElementById('modalCartQty');
      if (badgeModalCart) {
        badgeModalCart.textContent = c;
      }
    }

    /* ================== Moneda ================== */
    function penToUsd(pen){ return pen / FX; }
    function formatMoneyPen(n){ return 'S/ ' + (Number(n)||0).toFixed(2); }
    function formatMoneyUsd(n){ return '$ ' + (Number(n)||0).toFixed(2); }
    function fmt(nPen){
      if(nPen==null) return 'Consultar';
      return state.currency==='USD' ? formatMoneyUsd(penToUsd(nPen)) : formatMoneyPen(nPen);
    }
    function toPen(valUi){
      if(valUi==null) return null;
      return state.currency==='USD' ? (Number(valUi) * FX) : Number(valUi);
    }
    function fromPen(valPen){
      return state.currency==='USD' ? (valPen/FX) : valPen;
    }

    /* ================== Imagen por link (logo por dominio) ================== */
    function domainFromUrl(u){
      try{
        const url = new URL(normalizeUrl(u));
        return url.hostname.replace(/^www\./,'');
      }catch(e){
        return '';
      }
    }
    function primaryThumbFromDomain(domain){
      return domain ? `https://logo.clearbit.com/${domain}?size=512` : 'img/placeholder.jpg';
    }
    function fallbackThumbFromDomain(domain){
      return domain ? `https://www.google.com/s2/favicons?domain=${domain}&sz=256` : 'img/placeholder.jpg';
    }
    function resolveThumb(it){
      if(it.thumb) return it.thumb;
      const d = domainFromUrl(it.url);
      return primaryThumbFromDomain(d);
    }
    function resolveThumbFallback(it){
      const d = domainFromUrl(it.url);
      return fallbackThumbFromDomain(d);
    }

    /* ================== Disponible / Cupo ================== */
    function isDisponible(it){
      const disp = (it.disponible !== false);
      if(!disp) return false;
      if(typeof it.cupo === 'number' && it.cupo <= 0) return false;
      return true;
    }
    function statusLabel(it){
      if(!isDisponible(it)) return 'No disponible';
      if(typeof it.cupo === 'number') return `Disponible ‚Ä¢ ${it.cupo} cupos`;
      return 'Disponible';
    }
    function statusClass(it){
      return isDisponible(it) ? 'is-available' : 'is-unavailable';
    }
    function catLabel(cat){
      if(cat==='ai') return 'IA';
      if(cat==='streaming') return 'STREAM';
      if(cat==='musica') return 'VIDEO';
      if(cat==='otros') return 'TOOLS';
      return String(cat||'').toUpperCase();
    }

    function waUrl(msg, which='primary'){
      const phone = which==='secondary' ? WA_SECONDARY : WA_PRIMARY;
      return `https://wa.me/${phone}?text=${encodeURIComponent(msg)}`;
    }
    function consultWhatsApp(it){
      const name = it?.name ?? 'Producto';
      const price = it?.price ?? null;

      const modeTxt = state.mode==='wholesale' ? 'PROVEEDOR' : 'POR MENOR';
      const priceTxt = (price==null) ? 'Precio: consultar' : `Precio: ${formatMoneyPen(price)}`;
      const estadoTxt = isDisponible(it) ? 'Estado: DISPONIBLE' : 'Estado: NO DISPONIBLE';
      const cupoTxt = (typeof it?.cupo === 'number') ? `Cupo: ${it.cupo}` : 'Cupo: (no aplica)';

      const msg = `¬°Hola! üëã\nQuiero informaci√≥n sobre: ${name}\nModo: ${modeTxt}\n${priceTxt}\n${estadoTxt}\n${cupoTxt}`;
      window.open(waUrl(msg,'primary'), '_blank', 'noopener');
    }

    /* ==========================================================
       CAT√ÅLOGO (POR MENOR)
       ========================================================== */
    const CATALOG = [
      /* ===== IA ===== */
      {
        id:'rt-ai-gpt-8',
        priority: 1,
        name:'ChatGPT Plus',
        price:8,
        cat:'ai',
        url:'https://openai.com/chatgpt',
        shareUrl: SHARE_BASE + 'rt-ai-gpt-8.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Celular + PC','M√°s usuarios','Mensual'],
        desc:'Plan econ√≥mico para usar ChatGPT Plus en celular o PC.',
        benefits:[
          '‚úÖ Acceso mensual',
          'üë• Tiene m√°s usuarios (mejor disponibilidad)',
          'üì± Compatible en celular y PC',
          '‚ö° Entrega r√°pida',
        ],
        why:'Ideal si quieres buen precio y usarlo en m√°s de un dispositivo.'
      },
      {
        id:'rt-ai-gpt-12',
        priority: 2,
        name:'ChatGPT Plus (Solo Celular)',
        price:12,
        cat:'ai',
        url:'https://openai.com/chatgpt',
        shareUrl: SHARE_BASE + 'rt-ai-gpt-12.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Solo Celular','Pocos usuarios','No se satura','Mensual'],
        desc:'Plan solo para celular: pocos usuarios, estable y sin saturaci√≥n.',
        benefits:[
          '‚úÖ Acceso mensual (solo celular)',
          'üö´ No se satura (pocos usuarios)',
          'üì± Ideal para tareas, estudio y trabajo',
          '‚ö° Entrega inmediata',
          'üõü Soporte por WhatsApp'
        ],
        why:'Perfecto si lo usar√°s √∫nicamente en el tel√©fono y quieres estabilidad.'
      },
      {
        id:'rt-ai-gpt-18',
        priority: 3,
        name:'ChatGPT Plus (Solo PC)',
        price:18,
        cat:'ai',
        url:'https://openai.com/chatgpt',
        shareUrl: SHARE_BASE + 'rt-ai-gpt-18.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Solo PC','Windows 10/11','iOS/macOS','Regalo Perplexity','Mensual'],
        desc:'Plan para PC: compatible con Windows 10/11 y iOS/macOS. Incluye regalo Perplexity.',
        benefits:[
          '‚úÖ Acceso mensual (solo PC)',
          'üíª Compatible con Windows 10/11',
          'üçé Compatible con iOS/macOS (seg√∫n tu equipo)',
          'üéÅ Incluye Perplexity de regalo',
          'üõü Soporte por WhatsApp'
        ],
        why:'Si trabajas en computadora y quieres extras, este es el mejor combo.'
      },

      /* ===== VIDEO / EDICI√ìN ===== */
      {
        id:'rt-vid-capcut',
        priority: 4,
        name:'CapCut Pro',
        price:10,
        cat:'musica',
        url:'https://www.capcut.com',
        shareUrl: SHARE_BASE + 'rt-vid-capcut.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['1 dispositivo','Mensual','Edici√≥n Pro'],
        desc:'Edici√≥n premium para videos (solo 1 dispositivo). Ideal para TikTok/Reels.',
        benefits:[
          'üì± Solo 1 dispositivo',
          '‚ú® Efectos y plantillas Pro',
          'üé¨ Exportaci√≥n sin marcas (seg√∫n plan)',
          '‚ö° Activaci√≥n r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Para creadores: mejoras tus videos en minutos con herramientas Pro.'
      },

      /* ===== IA / GOOGLE ===== */
      {
        id:'rt-ai-gemini',
        priority: 5,
        name:'Gemini PRO + 2 TB Google One',
        price:15,
        cat:'ai',
        url:'https://gemini.google.com/app',
        shareUrl: SHARE_BASE + 'rt-ai-gemini.html',
        period:'1 a√±o',
        cupo:null,
        disponible:true,
        chips:['1 a√±o','2 TB','En tu Gmail','Gemini Pro'],
        desc:'Paquete anual activado en tu propio correo Gmail con 2 TB Google One + Gemini PRO.',
        benefits:[
          'üöÄ Gemini PRO + ‚òÅ 2 TB Google One',
          'üìß Activaci√≥n en tu propio correo Gmail',
          'ü§ñ Gemini Pro 3.1',
          'üé¨ Creaci√≥n de videos con IA',
          'üß† Animaciones, notas inteligentes y automatizaci√≥n',
          '‚úâ IA en Gmail, Docs y Meet',
          'üåä Flow'
        ],
        why:'Un a√±o completo con IA + almacenamiento grande en tu propia cuenta.'
      },
      {
        id:'rt-ai-googleone',
        priority: 6,
        name:'Google One 2TB + Gemini Pro',
        price:15,
        cat:'ai',
        url:'https://one.google.com',
        shareUrl: SHARE_BASE + 'rt-ai-googleone.html',
        period:'1 a√±o',
        cupo:null,
        disponible:true,
        chips:['1 a√±o','2 TB','En tu Gmail','Incluye Gemini'],
        desc:'2 TB de almacenamiento en tu cuenta + beneficios de Gemini integrados.',
        benefits:[
          '‚òÅ 2 TB Google One (en tu propio Gmail)',
          'üöÄ Incluye Gemini PRO (seg√∫n disponibilidad)',
          '‚úâ IA en Gmail, Docs y Meet',
          'üß† Herramientas inteligentes y automatizaci√≥n',
          '‚ö° Activaci√≥n directa en tu cuenta'
        ],
        why:'Para quienes necesitan almacenamiento + IA integrada en Google.'
      },
      {
        id:'rt-ai-perplexity',
        priority: 7,
        name:'Perplexity Pro',
        price:15,
        cat:'ai',
        url:'https://www.perplexity.ai',
        shareUrl: SHARE_BASE + 'rt-ai-perplexity.html',
        period:'1 a√±o',
        cupo:null,
        disponible:false,
        chips:['1 a√±o','B√∫squeda con fuentes','Activaci√≥n en tu cuenta'],
        desc:'IA para investigar con fuentes: respuestas r√°pidas, √∫tiles y verificables.',
        benefits:[
          'üöÄ Acceso a IA avanzadas (seg√∫n disponibilidad)',
          'üîç B√∫squedas inteligentes con fuentes reales',
          '‚ö° Respuestas r√°pidas, precisas y profesionales',
          'üì¶ Activaci√≥n directa en tu cuenta üîê',
          'üõü Soporte por WhatsApp'
        ],
        why:'Ideal para estudiar, investigar y trabajar con informaci√≥n m√°s confiable.'
      },

      /* ===== HERRAMIENTAS ===== */
      {
        id:'rt-tools-canva-1y',
        priority: 8,
        name:'Canva Pro',
        price:10,
        cat:'otros',
        url:'https://www.canva.com',
        shareUrl: SHARE_BASE + 'rt-tools-canva-1y.html',
        period:'1 a√±o',
        cupo:null,
        disponible:true,
        chips:['1 a√±o','Dise√±o Pro','Plantillas premium'],
        desc:'Dise√±o premium por 1 a√±o. Perfecto para marcas, negocios y contenido.',
        benefits:[
          'üé® Plantillas premium + recursos Pro',
          'üß© Kit de marca (logos, colores, tipograf√≠as)',
          'ü™Ñ Quitar fondo y herramientas Pro',
          'üì≤ √ötil para redes sociales y trabajos',
          'EDU'
        ],
        why:'Dise√±a como profesional sin pagar precios altos.'
      },
      {
        id:'rt-tools-canva-2y',
        priority: 9,
        name:'Canva Pro',
        price:14,
        cat:'otros',
        url:'https://www.canva.com',
        shareUrl: SHARE_BASE + 'rt-tools-canva-2y.html',
        period:'2 a√±os',
        cupo:30,
        disponible:true,
        chips:['2 a√±os','Ahorro','Dise√±o Pro'],
        desc:'Canva Pro por 2 a√±os: m√°s ahorro y tranquilidad.',
        benefits:[
          'üé® Todo Canva Pro',
          '‚è≥ Duraci√≥n: 2 a√±os',
          'üí∏ M√°s econ√≥mico que renovar mes a mes',
          'üìà Ideal para negocios y creadores',
          'EDU'
        ],
        why:'Mejor opci√≥n si usas Canva seguido (m√°s ahorro).'
      },
      {
        id:'rt-tools-canva-3y',
        priority: 10,
        name:'Canva Pro',
        price:18.9,
        cat:'otros',
        url:'https://www.canva.com',
        shareUrl: SHARE_BASE + 'rt-tools-canva-3y.html',
        period:'3 a√±os',
        cupo:30,
        disponible:true,
        chips:['3 a√±os','Top ahorro','Dise√±o Pro'],
        desc:'Canva Pro por 3 a√±os: m√°ximo ahorro.',
        benefits:[
          'üé® Todo Canva Pro',
          '‚è≥ Duraci√≥n: 3 a√±os',
          'üèÜ Mejor precio por a√±o',
          'üöÄ Ideal para agencias / emprendimientos',
          ' EDU'
        ],
        why:'La opci√≥n m√°s rentable si lo usar√°s por largo tiempo.'
      },

      {
        id:'rt-tools-autodesk',
        priority: 11,
        name:'Autodesk Suite',
        price:15,
        cat:'otros',
        url:'https://www.autodesk.com',
        shareUrl: SHARE_BASE + 'rt-tools-autodesk.html',
        period:'1 a√±o',
        cupo:null,
        disponible:true,
        chips:['1 a√±o','AutoCAD + Revit','Suite completa'],
        desc:'Autodesk por 1 a√±o: incluye herramientas CAD, BIM, modelado, render y m√°s.',
        benefits:[
          'üìê CAD / Dibujo: AutoCAD, AutoCAD LT, Mechanical, Electrical, Civil 3D‚Ä¶',
          'üèóÔ∏è BIM: Revit + Navisworks + InfraWorks‚Ä¶',
          'üß± Modelado/Render: 3ds Max, Maya, Arnold‚Ä¶',
          '‚öôÔ∏è Manufactura: Inventor, Fusion‚Ä¶',
          'üõü Soporte por WhatsApp'
        ],
        extraSections: [
          { title:'CAD / Dibujo', items:['AutoCAD','AutoCAD LT','AutoCAD Mechanical','AutoCAD Electrical','AutoCAD Map 3D','AutoCAD Civil 3D','AutoCAD Architecture','AutoCAD MEP','AutoCAD Raster Design'] },
          { title:'BIM / Construcci√≥n', items:['Revit','Revit Architecture','Revit Structure','Revit MEP','Navisworks Manage','Navisworks Simulate','InfraWorks','Advance Steel','FormIt'] },
          { title:'Dise√±o Mec√°nico / Manufactura', items:['Inventor','Inventor CAM','Inventor Nastran','Fusion','Fusion Design','Fusion Manufacturing','Fusion Electronics'] },
          { title:'Media / Animaci√≥n / Render', items:['3ds Max','Maya','Arnold','MotionBuilder','Mudbox'] },
          { title:'Infraestructura / GIS', items:['Vehicle Tracking','Storm and Sanitary Analysis','InfoDrainage'] },
          { title:'Construcci√≥n en la nube', items:['Autodesk Construction Cloud','BIM Collaborate','BIM Collaborate Pro','Docs','Build','Takeoff'] },
          { title:'Simulaci√≥n y An√°lisis', items:['Robot Structural Analysis','CFD','Moldflow'] },
          { title:'Utilidades', items:['Recap','Recap Pro','Design Review'] }
        ],
        why:'Perfecto para estudiantes y profesionales que necesitan la suite completa.'
      },

      {
        id:'rt-tools-office365',
        priority: 12,
        name:'Office 365 ‚Äî Consultar',
        price:null,
        cat:'otros',
        url:'https://www.microsoft.com/microsoft-365',
        shareUrl: SHARE_BASE + 'rt-tools-office365.html',
        period:'Consultar',
        cupo:null,
        disponible:true,
        chips:['Word','Excel','PowerPoint','En tu cuenta'],
        desc:'Office 365 (Word, Excel, PowerPoint y m√°s). Consultar disponibilidad.',
        benefits:[
          'üìÑ Word + üìä Excel + üìΩÔ∏è PowerPoint',
          '‚òÅÔ∏è OneDrive (seg√∫n plan)',
          'üíº Ideal para trabajo y universidad',
          '‚ö° Coordinaci√≥n r√°pida por WhatsApp'
        ],
        why:'Consulta y te pasamos el plan m√°s conveniente.'
      },

      /* ===== STREAMING ===== */
      {
        id:'rt-st-netflix',
        priority: 13,
        name:'Netflix',
        price:13,
        cat:'streaming',
        url:'https://www.netflix.com',
        shareUrl: SHARE_BASE + 'rt-st-netflix.html',
        period:'Mensual',
        cupo:5,
        disponible:true,
        chips:['Mensual','Streaming','Soporte'],
        desc:'Entretenimiento premium con soporte.',
        benefits:[
          'üé¨ Series y pel√≠culas',
          '‚ö° Entrega r√°pida',
          'üõü Soporte por WhatsApp',
          'üîí Configuraci√≥n guiada'
        ],
        why:'La cl√°sica: para maratonear sin complicaciones.'
      },
      {
        id:'rt-st-disney',
        priority: 14,
        name:'Disney Premium',
        price:8,
        cat:'streaming',
        url:'https://www.disneyplus.com',
        shareUrl: SHARE_BASE + 'rt-st-disney.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Mensual','Familiar','Streaming'],
        desc:'Disney Premium para toda la familia.',
        benefits:[
          'ü™Ñ Cat√°logo familiar',
          'üì∫ Ideal para series y pelis',
          '‚ö° Entrega r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Perfecto para casa, ni√±os y maratones.'
      },
      {
        id:'rt-st-hbo',
        priority: 15,
        name:'HBO / Max',
        price:7,
        cat:'streaming',
        url:'https://www.max.com',
        shareUrl: SHARE_BASE + 'rt-st-hbo.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Mensual','Series top','Streaming'],
        desc:'Series y pel√≠culas top del momento.',
        benefits:[
          'üì∫ Cat√°logo premium',
          '‚ö° Activaci√≥n r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Si te gustan las series fuertes, este es.'
      },
      {
        id:'rt-st-vix',
        priority: 16,
        name:'ViX',
        price:7,
        cat:'streaming',
        url:'https://vix.com',
        shareUrl: SHARE_BASE + 'rt-st-vix.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Mensual','Contenido LATAM','Streaming'],
        desc:'Contenido en espa√±ol y LATAM (seg√∫n regi√≥n).',
        benefits:[
          'üáµüá™ Contenido en espa√±ol',
          '‚ö° Entrega r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Ideal si buscas contenido latino.'
      },
      {
        id:'rt-st-prime',
        priority: 17,
        name:'Prime Video',
        price:8,
        cat:'streaming',
        url:'https://www.primevideo.com',
        shareUrl: SHARE_BASE + 'rt-st-prime.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Mensual','Estrenos','Streaming'],
        desc:'Estrenos y cl√°sicos: buena relaci√≥n calidad/precio.',
        benefits:[
          'üéûÔ∏è Cat√°logo variado',
          '‚ö° Entrega r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Gran alternativa para ver de todo.'
      },
      {
        id:'rt-st-iptv',
        priority: 18,
        name:'IPTV',
        price:8,
        cat:'streaming',
        url:'https://example.com',
        shareUrl: SHARE_BASE + 'rt-st-iptv.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Mensual','Canales','Soporte'],
        desc:'IPTV con opciones por regi√≥n y compatibilidad.',
        benefits:[
          'üì° Canales y contenido (seg√∫n plan)',
          'üß© Asesor√≠a de compatibilidad',
          '‚ö° Entrega r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Te ayudamos a elegir el plan ideal para tu equipo.'
      },
      {
        id:'rt-st-crunchy',
        priority: 19,
        name:'Crunchyroll',
        price:8,
        cat:'streaming',
        url:'https://www.crunchyroll.com',
        shareUrl: SHARE_BASE + 'rt-st-crunchy.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Mensual','Anime','Streaming'],
        desc:'Anime sin anuncios (seg√∫n plan).',
        benefits:[
          'üç• Cat√°logo de anime',
          '‚ö° Entrega r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Para fans del anime: simple y r√°pido.'
      },

      /* ===== VPN ===== */
      {
        id:'rt-vpn-surfshark-device',
        priority: 20,
        name:'Surfshark VPN (1 dispositivo)',
        price:7,
        cat:'otros',
        url:'https://surfshark.com',
        shareUrl: SHARE_BASE + 'rt-vpn-surfshark-device.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['1 dispositivo','Mensual','VPN'],
        desc:'VPN para 1 dispositivo. √ötil para privacidad y acceso (seg√∫n regi√≥n).',
        benefits:[
          'üîí Privacidad y seguridad',
          'üì± 1 dispositivo',
          '‚ö° Activaci√≥n r√°pida',
          'üõü Soporte por WhatsApp'
        ],
        why:'Ideal si quieres VPN econ√≥mica para un solo equipo.'
      }

    ];

    /* ==========================================================
       CAT√ÅLOGO (PROVEEDORES / CUENTAS COMPLETAS)
       ========================================================== */
    const WHOLESALE = [
      {
        id:'wh-ai-chatgpt-full',
        priority: 1,
        name:'ChatGPT Plus ‚Äî Cuenta completa (Proveedor)',
        price:40,
        cat:'ai',
        url:'https://openai.com/chatgpt',
        shareUrl: SHARE_BASE + 'wh-ai-chatgpt-full.html',
        period:'Mensual',
        cupo:0,
        disponible:false,
        chips:['Cuenta completa','Agotado'],
        desc:'Cuenta completa para proveedor. Actualmente sin cupo.',
        benefits:[
          'üîë Cuenta completa (control total)',
          'üõü Soporte para proveedor',
          '‚ö†Ô∏è Ahora: sin cupo'
        ],
        why:'Cuando vuelve stock, avisamos por WhatsApp.'
      },
      {
        id:'wh-st-disney-7u',
        priority: 2,
        name:'Disney Premium (7 usuarios)',
        price:25,
        cat:'streaming',
        url:'https://www.disneyplus.com',
        shareUrl: SHARE_BASE + 'wh-st-disney-7u.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['7 usuarios','Proveedor','Mensual'],
        desc:'Plan para proveedor: hasta 7 usuarios (multiusuario).',
        benefits:[
          'üë• Hasta 7 usuarios',
          'ü™Ñ Cat√°logo familiar',
          '‚ö° Entrega r√°pida',
          'üõü Soporte a proveedores'
        ],
        why:'Perfecto para revender o gestionar varios clientes.'
      },
      {
        id:'wh-vid-capcut-3d',
        priority: 3,
        name:'CapCut Pro (3 dispositivos)',
        price:15,
        cat:'musica',
        url:'https://www.capcut.com',
        shareUrl: SHARE_BASE + 'wh-vid-capcut-3d.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['3 dispositivos','Proveedor','Mensual'],
        desc:'CapCut Pro para proveedor: hasta 3 dispositivos.',
        benefits:[
          'üì± Hasta 3 dispositivos',
          '‚ú® Herramientas Pro',
          '‚ö° Activaci√≥n r√°pida',
          'üõü Soporte a proveedores'
        ],
        why:'Ideal para vender a creadores o agencias de contenido.'
      },
      {
        id:'wh-tools-canva-500',
        priority: 4,
        name:'Canva (hasta 500 usuarios)',
        price:35,
        cat:'otros',
        url:'https://www.canva.com',
        shareUrl: SHARE_BASE + 'wh-tools-canva-500.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['500 usuarios','Proveedor','Mensual'],
        desc:'Plan para proveedor: gran capacidad de usuarios.',
        benefits:[
          'üë• Hasta 500 usuarios (seg√∫n configuraci√≥n)',
          'üé® Recursos Pro y plantillas',
          '‚ö° Entrega r√°pida',
          'üõü Soporte a proveedores'
        ],
        why:'Para equipos grandes o reventa a escala.'
      },
      {
        id:'wh-tools-autodesk-250-1y',
        priority: 5,
        name:'Autodesk (250 usuarios)',
        price:35,
        cat:'otros',
        url:'https://www.autodesk.com',
        shareUrl: SHARE_BASE + 'wh-tools-autodesk-250-1y.html',
        period:'1 a√±o',
        cupo:2,
        disponible:true,
        chips:['250 usuarios','1 a√±o','Cupo 2','Proveedor'],
        desc:'Autodesk para proveedor: 250 usuarios por 1 a√±o (cupos limitados).',
        benefits:[
          'üë• 250 usuarios',
          '‚è≥ 1 a√±o',
          'üìê CAD + BIM + Render',
          'üõü Soporte a proveedores'
        ],
        why:'Muy buena opci√≥n para empresas/equipos grandes (cupos limitados).'
      },
      {
        id:'wh-tools-autodesk-3000-3y',
        priority: 6,
        name:'Autodesk (3000 usuarios)',
        price:60,
        cat:'otros',
        url:'https://www.autodesk.com',
        shareUrl: SHARE_BASE + 'wh-tools-autodesk-3000-3y.html',
        period:'3 a√±os',
        cupo:null,
        disponible:true,
        chips:['3000 usuarios','3 a√±os','Proveedor'],
        desc:'Plan masivo para proveedor: 3000 usuarios por 3 a√±os.',
        benefits:[
          'üë• 3000 usuarios',
          '‚è≥ 3 a√±os',
          'üìê Suite profesional',
          'üõü Soporte a proveedores'
        ],
        why:'Para proyectos grandes o reventa a escala (muy rentable).'
      },
      {
        id:'wh-st-youtube-5u',
        priority: 7,
        name:'YouTube (5 usuarios / no renovable)',
        price:7,
        cat:'streaming',
        url:'https://www.youtube.com/premium',
        shareUrl: SHARE_BASE + 'wh-st-youtube-5u.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['5 usuarios','No renovable','Proveedor'],
        desc:'Cuenta para proveedor: 5 usuarios. No renovable (se gestiona por periodos).',
        benefits:[
          'üë• 5 usuarios',
          'üö´ No renovable',
          '‚ñ∂Ô∏è Sin anuncios y segundo plano (seg√∫n plan)',
          'üõü Soporte a proveedores'
        ],
        why:'Ideal para ofrecer packs a varios clientes.'
      },
      {
        id:'wh-st-crunchy-full',
        priority: 8,
        name:'Crunchyroll',
        price:25,
        cat:'streaming',
        url:'https://www.crunchyroll.com',
        shareUrl: SHARE_BASE + 'wh-st-crunchy-full.html',
        period:'Mensual',
        cupo:null,
        disponible:true,
        chips:['Cuenta completa','Proveedor','Mensual'],
        desc:'Cuenta completa mensual para proveedor.',
        benefits:[
          'üç• Anime',
          'üîë Cuenta completa',
          '‚ö° Entrega r√°pida',
          'üõü Soporte a proveedores'
        ],
        why:'Producto premium para fans (mejor margen).'
      },
      {
        id:'wh-vpn-surfshark-full-3m',
        priority: 9,
        name:'Surfshark VPN',
        price:32,
        cat:'otros',
        url:'https://surfshark.com',
        shareUrl: SHARE_BASE + 'wh-vpn-surfshark-full-3m.html',
        period:'3 meses',
        cupo:null,
        disponible:true,
        chips:['Cuenta completa','3 meses','Proveedor'],
        desc:'VPN cuenta completa por 3 meses.',
        benefits:[
          'üîí Privacidad y seguridad',
          'üîë Cuenta completa',
          '‚è≥ Duraci√≥n: 3 meses',
          'üõü Soporte a proveedores'
        ],
        why:'Plan perfecto para vender como pack trimestral.'
      }
    ];

    function currentCatalog(){ return state.mode==='retail' ? CATALOG : WHOLESALE; }

    /* ================== Render ================== */
    const grid = document.getElementById('productsGrid');
    const pag = document.getElementById('pagination');
    const sectionTitle = document.getElementById('sectionTitle');

    function byCats(items){ return items.filter(it => state.cats.has(it.cat)); }
    function byPrice(items){
      const minPen = toPen(state.min);
      const maxPen = toPen(state.max);
      return items.filter(it => {
        if(it.price==null) return true;
        if(minPen!=null && it.price < minPen) return false;
        if(maxPen!=null && it.price > maxPen) return false;
        return true;
      });
    }
    function priceForSort(v,dir){
      if(v==null) return dir==='desc' ? -Infinity : Infinity;
      return v;
    }
    function sortItems(items){
      const arr = [...items];
      const s = state.sort;

      if (s === 'relevance') {
        arr.sort((a, b) => {
          const pa = (typeof a.priority === 'number') ? a.priority : 9999;
          const pb = (typeof b.priority === 'number') ? b.priority : 9999;
          if (pa !== pb) return pa - pb;
          return a.name.localeCompare(b.name);
        });
      } else if (s === 'price-asc') {
        arr.sort((a,b)=> priceForSort(a.price,'asc') - priceForSort(b.price,'asc'));
      } else if (s === 'price-desc') {
        arr.sort((a,b)=> priceForSort(b.price,'desc') - priceForSort(a.price,'desc'));
      } else if (s === 'name-asc') {
        arr.sort((a,b)=>a.name.localeCompare(b.name));
      } else if (s === 'name-desc') {
        arr.sort((a,b)=>b.name.localeCompare(a.name));
      }

      return arr;
    }

    function getFilterMaxPen(){
      const prices = currentCatalog().map(it=>it.price).filter(p=>typeof p === 'number');
      const max = prices.length ? Math.max(...prices) : 30;
      const minCap = (state.mode==='retail') ? 30 : 60;
      return Math.max(minCap, Math.ceil(max));
    }

    const minI = document.getElementById('minPrice');
    const maxI = document.getElementById('maxPrice');
    const priceLabel = document.getElementById('priceLabel');

    function updatePriceLabel(){
      const maxPen = getFilterMaxPen();
      if(state.currency==='USD'){
        priceLabel.textContent = `Rango (USD 0.00‚Äì${fromPen(maxPen).toFixed(2)})`;
      }else{
        priceLabel.textContent = `Rango (S/ 0‚Äì${maxPen})`;
      }
    }
    function resetPriceInputs(){
      const maxPen = getFilterMaxPen();
      const maxUi = fromPen(maxPen);
      minI.value = state.currency==='USD' ? (0).toFixed(2) : '0';
      maxI.value = state.currency==='USD' ? maxUi.toFixed(2) : String(maxPen);
      state.min = 0;
      state.max = maxUi;
      updatePriceLabel();
    }

    function render(){
      sectionTitle.innerHTML = (state.mode==='retail')
        ? 'Productos <small class="text-muted">por menor</small>'
        : 'Proveedores <small class="text-muted">cuentas completas</small>';

      const BASE = currentCatalog();
      const filtered = byPrice(byCats(BASE));
      const sorted = sortItems(filtered);

      const totalPages = Math.max(1, Math.ceil(sorted.length / PAGE_SIZE));
      if(state.page > totalPages) state.page = totalPages;

      const start = (state.page-1)*PAGE_SIZE;
      const pageItems = sorted.slice(start, start+PAGE_SIZE);

      grid.innerHTML = pageItems.map(cardHTML).join('');
      bindCards();

      renderPagination(totalPages);

      document.querySelectorAll('[data-price-pen]').forEach(el=>{
        const pen = el.getAttribute('data-price-pen');
        el.textContent = pen==='null' ? 'Consultar' : fmt(parseFloat(pen));
      });
    }

    function cardHTML(it){
      const penAttr = (it.price==null) ? 'null' : String(it.price);
      const disponible = isDisponible(it);
      const thumb = resolveThumb(it);
      const fallback = resolveThumbFallback(it);
      const period = it.period ? `<div class="period-note">${esc(it.period)}</div>` : '';

      return `
        <div class="col-6 col-sm-6 col-md-4 col-lg-3 pb-1">
          <div class="product-item mb-4 ${!disponible?'is-unavailable':''}"
               data-id="${esc(it.id)}"
               data-name="${esc(it.name)}"
               data-price="${it.price==null?'':esc(it.price)}"
               data-cat="${esc(it.cat)}"
               data-cupo="${(typeof it.cupo==='number') ? esc(it.cupo) : ''}"
               data-disponible="${(it.disponible===false) ? '0' : '1'}"
               data-url="${esc(normalizeUrl(it.url))}"
               data-period="${esc(it.period||'')}"
               data-chips="${esc(JSON.stringify(it.chips||[]))}">

            <div class="product-img overflow-hidden">
              <span class="status-pill ${statusClass(it)}">${esc(statusLabel(it))}</span>

              <img class="img-fluid w-100"
                   src="${esc(thumb)}"
                   data-fallback="${esc(fallback)}"
                   data-placeholder="img/placeholder.jpg"
                   loading="lazy"
                   decoding="async"
                   referrerpolicy="no-referrer"
                   alt="${esc(it.name)}">

              <div class="product-action">
                <button class="btn btn-outline-dark btn-square btn-add" title="Agregar al carrito" ${(!disponible || it.price==null)?'disabled':''}>
                  <i class="fa fa-shopping-cart"></i>
                </button>

                <button class="btn btn-outline-dark btn-square btn-detail" title="Ver informaci√≥n">
                  <i class="fa fa-info-circle"></i> <span>Info</span>
                </button>

                <button class="btn btn-outline-dark btn-square btn-buy" title="${it.price==null?'Consultar por WhatsApp':'Comprar ahora'}" ${(!disponible)?'disabled':''}>
                  <i class="fas fa-bolt"></i>
                </button>
              </div>
            </div>

            <div class="text-center py-4">
              <a class="h6 text-decoration-none text-truncate js-title" href="#p=${encodeURIComponent(it.id)}">${esc(it.name)}</a>
              <div class="d-flex align-items-center justify-content-center mt-2">
                <h5 data-price-pen="${penAttr}">${it.price==null?'Consultar':fmt(it.price)}</h5>
              </div>
              ${period}
              <div class="cat-chip">${catLabel(it.cat)}</div>
            </div>
          </div>
        </div>
      `;
    }

    function renderPagination(totalPages){
      let html = '';
      html += `<li class="page-item ${state.page===1?'disabled':''}">
        <a class="page-link js-page" data-page="${state.page-1}" href="#">Anterior</a>
      </li>`;
      for(let p=1;p<=totalPages;p++){
        html += `<li class="page-item ${state.page===p?'active':''}">
          <a class="page-link js-page" data-page="${p}" href="#">${p}</a>
        </li>`;
      }
      html += `<li class="page-item ${state.page===totalPages?'disabled':''}">
        <a class="page-link js-page" data-page="${state.page+1}" href="#">Siguiente</a>
      </li>`;

      pag.innerHTML = html;
      pag.querySelectorAll('.js-page').forEach(a=>{
        a.addEventListener('click', e=>{
          e.preventDefault();
          const p = Number(a.getAttribute('data-page'));
          if(!isNaN(p) && p>=1 && p<=totalPages){
            state.page = p;
            render();
            window.scrollTo({top:0, behavior:'smooth'});
          }
        });
      });
    }

    /* ================== Acciones tarjetas ================== */
    function bindCards(){
      document.querySelectorAll('.product-item').forEach(card=>{
        const id = card.getAttribute('data-id');
        const nombre = card.getAttribute('data-name');

        const priceStr = card.getAttribute('data-price');
        const precio = (priceStr==='' ? null : Number(priceStr));

        const dispFlag = card.getAttribute('data-disponible');
        const cupoStr = card.getAttribute('data-cupo');
        const cupo = (cupoStr==='' ? null : Number(cupoStr));
        const disponible = (dispFlag !== '0') && !(typeof cupo === 'number' && cupo <= 0);

        const imgEl  = card.querySelector('.product-img img');
        const addBtn = card.querySelector('.btn-add');
        const buyBtn = card.querySelector('.btn-buy');
        const detBtn = card.querySelector('.btn-detail');
        const titleA = card.querySelector('.js-title');

        // fallback imagen
        if(imgEl){
          imgEl.dataset.errstep = '0';
          imgEl.addEventListener('error', ()=>{
            const step = Number(imgEl.dataset.errstep || '0') + 1;
            imgEl.dataset.errstep = String(step);
            if(step===1 && imgEl.dataset.fallback) imgEl.src = imgEl.dataset.fallback;
            else if(step>=2) imgEl.src = imgEl.dataset.placeholder || 'img/placeholder.jpg';
          });
        }

        function addOrConsult(action){
          const it = findItemById(id);
          if(!it) return;

          if(!disponible){
            showToast('No disponible: ' + nombre);
            return;
          }

          // Si es ‚ÄúConsultar‚Äù
          if(precio==null){
            consultWhatsApp(it);
            return;
          }

          const imagenFinal = imgEl ? (imgEl.currentSrc || imgEl.src) : '';
          Cart.add({ id, nombre, precio, imagen: imagenFinal, qty:1 });
          syncHeaderBadges();

          flyToCart({
            originEl: imgEl || (action==='buy'?buyBtn:addBtn),
            emoji: '',
            imgUrl: imagenFinal,
            onEnd: attentionCartBadge
          });

          showToast('A√±adido: ' + nombre);

          if(action==='buy'){
            setTimeout(()=>{ window.location.href='checkout.html'; }, SETTINGS.cartRedirectDelay);
          }
        }

        if(addBtn){ addBtn.addEventListener('click', e=>{ e.preventDefault(); addOrConsult('add'); }); }
        if(buyBtn){ buyBtn.addEventListener('click', e=>{ e.preventDefault(); addOrConsult('buy'); }); }
        if(detBtn){ detBtn.addEventListener('click', e=>{ e.preventDefault(); openDetail(id); }); }
        if(titleA){ titleA.addEventListener('click', e=>{ e.preventDefault(); openDetail(id); }); }
      });
    }

    function findItemById(id){
      const all = [...CATALOG, ...WHOLESALE];
      return all.find(x => x.id === id) || null;
    }

    /* ================== Modal detalle ================== */
    const $modal = $('#productModal');
    const elTitle  = document.getElementById('modalTitle');
    const elImg    = document.getElementById('modalImg');
    const elPrice  = document.getElementById('modalPrice');
    const elUsd    = document.getElementById('modalUsd');
    const elStatus = document.getElementById('modalStatus');
    const elChips  = document.getElementById('modalChips');
    const elDesc   = document.getElementById('modalDesc');
    const elBen    = document.getElementById('modalBenefits');
    const elWhy    = document.getElementById('modalWhy');
    const elExtra  = document.getElementById('modalExtra');
    const btnAdd   = document.getElementById('modalAdd');
    const btnBuy   = document.getElementById('modalBuy');
    const btnCopy  = document.getElementById('modalCopyLink');
    const btnModalCart = document.getElementById('modalCartBtn');

    let modalItem = null;

    if(btnCopy){
      btnCopy.addEventListener('click', async ()=>{
        if(!modalItem) return;

        // Si el producto tiene shareUrl, se usa para que redes lean sus metas OG
        const link = modalItem.shareUrl || buildProductLink(modalItem.id);

        const ok = await copyToClipboard(link);
        showToast(ok ? 'Link copiado ‚úÖ' : 'No se pudo copiar');
        if(!ok){
          try{ window.prompt('Copia el link del producto:', link); }catch(e){}
        }
      });
    }

    if(btnModalCart){
      btnModalCart.addEventListener('click', ()=>{
        window.location.href = 'cart.html';
      });
    }

    function openDetail(id){
      const it = findItemById(id);
      if(!it) return;
      modalItem = it;

      /* ‚úÖ Actualiza hash: shop.html#p=ID */
      setProductHash(it.id);

      document.getElementById('productModalLabel').textContent = it.name;
      elTitle.textContent = it.name;

      elImg.src = resolveThumb(it);
      elImg.onerror = () => { elImg.src = resolveThumbFallback(it); };

      elPrice.textContent = fmt(it.price);

      if(it.price==null){
        elUsd.textContent = 'Precio a consultar';
      }else{
        elUsd.textContent = state.currency==='USD'
          ? `‚âà ${formatMoneyPen(it.price)} en S/`
          : `‚âà ${formatMoneyUsd(penToUsd(it.price))} en USD`;
      }

      // Estado (verde/rojo)
      const disp = isDisponible(it);
      elStatus.textContent = disp ? 'Disponible' : 'No disponible';
      elStatus.style.color = disp ? '#198754' : '#ff3b30';

      // Chips
      elChips.innerHTML = '';
      const chips = Array.isArray(it.chips) ? it.chips : [];
      const cupoChip = (typeof it.cupo === 'number') ? `Cupos: ${it.cupo}` : null;
      const periodChip = it.period ? `‚è≥ ${it.period}` : null;

      [...chips, cupoChip, periodChip].filter(Boolean).forEach(txt=>{
        const div = document.createElement('div');
        div.className = 'meta-chip';
        div.innerHTML = `<i class="fa fa-star"></i> ${esc(txt)}`;
        elChips.appendChild(div);
      });

      elDesc.textContent = it.desc || 'Servicio digital con entrega inmediata por WhatsApp.';

      // Beneficios
      elBen.innerHTML = '';
      (it.benefits || []).forEach(b=>{
        const li = document.createElement('li');
        li.innerHTML = `<i class="fa fa-check-circle"></i><div>${esc(b)}</div>`;
        elBen.appendChild(li);
      });

      // Why
      elWhy.textContent = it.why || 'Precio competitivo, soporte y entrega r√°pida.';

      // Extra (Autodesk y otros con secciones)
      if(Array.isArray(it.extraSections) && it.extraSections.length){
        elExtra.classList.remove('d-none');
        elExtra.innerHTML = `<div class="font-weight-bold mb-2">üì¶ Suite / M√°s informaci√≥n</div>` +
          it.extraSections.map(sec=>{
            const itemsHtml = (sec.items||[]).map(x=>`<div>${esc(x)}</div>`).join('');
            return `
              <details>
                <summary>${esc(sec.title)}</summary>
                <div class="mini-grid">${itemsHtml}</div>
              </details>
            `;
          }).join('');
      }else{
        elExtra.classList.add('d-none');
        elExtra.innerHTML = '';
      }

      // Botones
      btnAdd.disabled = (!disp) || (it.price==null);
      btnBuy.disabled = (!disp);

      if(it.price==null){
        btnBuy.innerHTML = '<i class="fab fa-whatsapp"></i> Consultar por WhatsApp';
      }else{
        btnBuy.innerHTML = '<i class="fas fa-bolt"></i> Comprar ahora';
      }

      syncHeaderBadges(); // actualiza contador carrito dentro del modal
      $modal.modal('show');
    }

    btnAdd.addEventListener('click', ()=>{
      if(!modalItem) return;
      if(!isDisponible(modalItem)) return showToast('No disponible: ' + modalItem.name);
      if(modalItem.price==null) return consultWhatsApp(modalItem);

      Cart.add({ id: modalItem.id, nombre: modalItem.name, precio: modalItem.price||0, imagen: elImg.src, qty:1 });
      syncHeaderBadges();
      flyToCart({ originEl: elImg, emoji:'', imgUrl: elImg.src, onEnd: attentionCartBadge });
      showToast('A√±adido: ' + modalItem.name);
    });

    btnBuy.addEventListener('click', ()=>{
      if(!modalItem) return;
      if(!isDisponible(modalItem)) return showToast('No disponible: ' + modalItem.name);

      if(modalItem.price==null){
        consultWhatsApp(modalItem);
        return;
      }

      Cart.add({ id: modalItem.id, nombre: modalItem.name, precio: modalItem.price||0, imagen: elImg.src, qty:1 });
      syncHeaderBadges();
      flyToCart({ originEl: elImg, emoji:'', imgUrl: elImg.src, onEnd: attentionCartBadge });
      setTimeout(()=>{ window.location.href='checkout.html'; }, SETTINGS.cartRedirectDelay);
    });

    /* ================== Fly-to-cart ================== */
    function pageOffsetRect(el){
      const r = el.getBoundingClientRect();
      return { x: r.left + window.scrollX, y: r.top + window.scrollY, w: r.width, h: r.height };
    }
    function findCartBadge(){
      const d = document.getElementById('headerCartBadge');
      const m = document.getElementById('headerCartBadgeSm');
      const inViewport = (el) => el && !!(el.offsetParent || el.getClientRects().length);
      return inViewport(d) ? d : (m || d);
    }
    function attentionCartBadge(){
      const b = findCartBadge();
      if(!b) return;
      b.classList.remove('cart-attn');
      void b.offsetWidth;
      b.classList.add('cart-attn');
      setTimeout(()=> b.classList.remove('cart-attn'), 750);
    }

    function bezier(t, p0, p1, p2){
      const u=1-t;
      return { x:u*u*p0.x + 2*u*t*p1.x + t*t*p2.x, y:u*u*p0.y + 2*u*t*p1.y + t*t*p2.y };
    }
    const easeOutCubic = t => 1 - Math.pow(1 - t, 3);

    function spawnTrail(x,y,idx){
      const dot = document.createElement('div');
      dot.className = 'trail';
      const cs = getComputedStyle(document.documentElement);
      dot.style.color = [cs.getPropertyValue('--trail-c1'), cs.getPropertyValue('--trail-c2'), cs.getPropertyValue('--trail-c3')][idx%3].trim();
      dot.style.left = (x - SETTINGS.trailSize/2) + 'px';
      dot.style.top  = (y - SETTINGS.trailSize/2) + 'px';
      dot.style.width = dot.style.height = (SETTINGS.trailSize + Math.random()*4) + 'px';
      document.body.appendChild(dot);
      setTimeout(()=> dot.remove(), SETTINGS.trailDurationMs);
    }

    function makeGhost(fromEl, emoji, imgUrl){
      const g = document.createElement('div'); g.className = 'fly-ghost';
      const from = pageOffsetRect(fromEl);
      g.style.left = (from.x + from.w/2 - 21) + 'px';
      g.style.top  = (from.y + from.h/2 - 21) + 'px';
      if(emoji){ g.textContent = emoji; }
      else if(imgUrl){
        g.classList.add('is-img');
        const im=document.createElement('img'); im.src=imgUrl;
        g.appendChild(im);
      }else{ g.textContent = 'üõí'; }
      document.body.appendChild(g);
      return g;
    }

    function flyToCart({ originEl, emoji, imgUrl, onEnd }){
      const cartBadge = findCartBadge();
      if(!cartBadge || window.matchMedia('(prefers-reduced-motion: reduce)').matches){
        onEnd && onEnd(); return;
      }
      const ghost = makeGhost(originEl, emoji, imgUrl);
      const start = pageOffsetRect(originEl);
      const end = pageOffsetRect(cartBadge);

      const p0 = { x: start.x + start.w/2, y: start.y + start.h/2 };
      const p2 = { x: end.x + end.w/2,   y: end.y + end.h/2 };
      const p1 = { x: (p0.x + p2.x)/2,   y: Math.min(p0.y, p2.y) - 120 };

      const t0 = performance.now();
      let lastTrail=-1e9, idx=0;

      function frame(now){
        const dt = now - t0;
        const t = Math.min(1, dt / SETTINGS.flyDurationMs);
        const et = easeOutCubic(t);
        const pos = bezier(et, p0, p1, p2);

        ghost.style.transform = `translate(${pos.x - p0.x}px, ${pos.y - p0.y}px) scale(${1 - et*0.3}) rotate(${et*20}deg)`;

        if(dt - lastTrail > SETTINGS.flyDurationMs / SETTINGS.trailDensity){
          spawnTrail(pos.x,pos.y,idx++);
          lastTrail = dt;
        }

        if(t < 1) requestAnimationFrame(frame);
        else { ghost.remove(); onEnd && onEnd(); }
      }
      requestAnimationFrame(frame);
    }

    /* ================== Toast ================== */
    const toast = document.getElementById('toastMini');
    const toastText = document.getElementById('toastText');
    let toastTimer = null;
    function showToast(msg='A√±adido al carrito'){
      if(!toast) return;
      toastText.textContent = msg;
      toast.classList.add('show');
      clearTimeout(toastTimer);
      toastTimer = setTimeout(()=> toast.classList.remove('show'), SETTINGS.toastTime);
    }

    /* ================== Filtros ================== */
    document.getElementById('applyFilters').addEventListener('click', ()=>{
      const min = minI.value.trim()==='' ? null : Number(minI.value);
      const max = maxI.value.trim()==='' ? null : Number(maxI.value);
      state.min = isNaN(min) ? null : min;
      state.max = isNaN(max) ? null : max;
      state.page = 1;
      render();
    });

    document.getElementById('clearFilters').addEventListener('click', ()=>{
      resetPriceInputs();
      state.page = 1;
      render();
    });

    document.querySelectorAll('.js-cat').forEach(chk=>{
      chk.addEventListener('change', ()=>{
        if(chk.checked) state.cats.add(chk.value);
        else state.cats.delete(chk.value);
        state.page = 1;
        render();
      });
    });

    document.getElementById('sortSelect').addEventListener('change', e=>{
      state.sort = e.target.value;
      state.page = 1;
      render();
    });

    /* ================== Tipo de venta ================== */
    const modeRetailBtn = document.getElementById('modeRetailBtn');
    const modeWholesaleBtn = document.getElementById('modeWholesaleBtn');

    modeRetailBtn.addEventListener('click', ()=>{
      state.mode = 'retail';
      state.page = 1;
      resetPriceInputs();
      render();
      modeRetailBtn.classList.add('active');
      modeWholesaleBtn.classList.remove('active');
    });

    modeWholesaleBtn.addEventListener('click', ()=>{
      state.mode = 'wholesale';
      state.page = 1;
      resetPriceInputs();
      render();
      modeWholesaleBtn.classList.add('active');
      modeRetailBtn.classList.remove('active');
    });

    /* ================== Moneda ================== */
    const currencyBtn = document.getElementById('currencyBtn');
    document.querySelectorAll('.js-set-currency').forEach(btn=>{
      btn.addEventListener('click', ()=>{
        setCurrency(btn.getAttribute('data-currency'));
      });
    });

    function setCurrency(cur){
      state.currency = cur;
      localStorage.setItem('innov_currency', cur);
      currencyBtn.textContent = (cur==='USD' ? 'USD' : 'Soles');
      resetPriceInputs();
      render();
    }

    /* ================== Men√∫ categor√≠as ================== */
    document.querySelectorAll('.js-nav-cat').forEach(a=>{
      a.addEventListener('click', (e)=>{
        e.preventDefault();
        const cat = a.getAttribute('data-cat');
        state.cats = new Set([cat]);
        document.querySelectorAll('.js-cat').forEach(chk=>{
          chk.checked = (chk.value === cat);
        });
        state.page = 1;
        render();
      });
    });

    /* ================== Limpieza carrito al volver de pago ================== */
    (function maybeClearCartFromQuery(){
      const qs = new URLSearchParams(location.search);
      if(qs.get('paid') === '1'){
        Cart.clear();
        syncHeaderBadges();
        showToast('Compra finalizada. Carrito limpiado.');
        qs.delete('paid');
        const tail = qs.toString();
        history.replaceState({}, '', location.pathname + (tail ? '?' + tail : ''));
      }
    })();

    /* ================== Back to top ================== */
    (function(){
      const back = document.querySelector('.back-to-top');
      if(!back) return;
      back.addEventListener('click', e=>{
        e.preventDefault();
        window.scrollTo({ top:0, behavior:'smooth' });
      });
    })();

    /* ================== WhatsApp badges ================== */
    (function(){
      var btn1 = document.getElementById('whatsappFab');
      var badge1 = document.getElementById('whatsappBadge');
      var btn2 = document.getElementById('whatsappFab2');
      var badge2 = document.getElementById('whatsappBadge2');
      try {
        if (sessionStorage.getItem('waBadgeHidden')==='1') { badge1 && (badge1.style.display='none'); }
        if (sessionStorage.getItem('waBadge2Hidden')==='1') { badge2 && (badge2.style.display='none'); }
      } catch(e){}
      if(btn1 && badge1){
        btn1.addEventListener('click', function(){
          badge1.style.display='none';
          try { sessionStorage.setItem('waBadgeHidden','1'); } catch(e){}
        });
      }
      if(btn2 && badge2){
        btn2.addEventListener('click', function(){
          badge2.style.display='none';
          try { sessionStorage.setItem('waBadge2Hidden','1'); } catch(e){}
        });
      }
    })();

    /* ================== Bot√≥n filtros: cambia texto al abrir/cerrar ================== */
    (function(){
      const btn = document.getElementById('filtersToggleBtn');
      if(!btn) return;
      try{
        $('#filtersCollapse').on('show.bs.collapse', function(){
          btn.innerHTML = '<i class="fa fa-times mr-2"></i> Cerrar filtros';
        });
        $('#filtersCollapse').on('hide.bs.collapse', function(){
          btn.innerHTML = '<i class="fa fa-filter mr-2"></i> Filtros';
        });
      }catch(e){}
    })();

    /* ================== INIT ================== */
    setCurrency(state.currency);
    document.getElementById('sortSelect').value = state.sort;
    syncHeaderBadges();

    window.addEventListener('storage', function(e){
      if(e.key==='innov_currency'){
        setCurrency(localStorage.getItem('innov_currency')||'PEN');
      }
    });

    /* ‚úÖ Abrir producto directo si viene link #p=ID */
    (function openFromHash(){
      const pid = getProductFromHash();
      if(!pid) return;
      const it = findItemById(pid);
      if(!it) return;

      // Si es un producto de proveedores, cambia modo para que tenga sentido visualmente.
      const isWh = WHOLESALE.some(x => x.id === pid);
      if(isWh && state.mode !== 'wholesale'){
        state.mode = 'wholesale';
        resetPriceInputs();
        render();
        modeWholesaleBtn.classList.add('active');
        modeRetailBtn.classList.remove('active');
      }
      if(!isWh && state.mode !== 'retail'){
        state.mode = 'retail';
        resetPriceInputs();
        render();
        modeRetailBtn.classList.add('active');
        modeWholesaleBtn.classList.remove('active');
      }

      // En m√≥vil, cerramos filtros para que no estorbe
      try { $('#filtersCollapse').collapse('hide'); } catch(e){}

      openDetail(pid);
    })();

  })();
  </script>
</body>
</html>

