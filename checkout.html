<!DOCTYPE html>
<html lang="es">
<head>
  <!-- Favicon -->
  <link
    rel="icon"
    href="https://scontent-lga3-1.xx.fbcdn.net/v/t39.30808-6/615837823_122108019525185356_8176358403674802319_n.jpg?_nc_cat=108&ccb=1-7&_nc_sid=6ee11a&_nc_ohc=7tEmsLyO4TMQ7kNvwGfRNY0&_nc_oc=AdlfbnpxuiqhgqJxBG38AtVd7x38Ti8Ew-hs0JrWo4f5M0W6I-vWy2OJuI5Uc8i4h8w&_nc_zt=23&_nc_ht=scontent-lga3-1.xx&_nc_gid=l7gJgstSbBRAp3umgmGmbA&oh=00_AfoFO9c2Wu9POry19NovrQLkBGmpXfEyFCWnVMrMPHzXeA&oe=696C2D63"
  />

  <!-- Google Web Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link
    href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Comic+Neue:wght@400;700&family=Bangers&display=swap"
    rel="stylesheet"
  />

  <!-- Font Awesome -->
  <link
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css"
    rel="stylesheet"
  />

  <!-- Libraries Stylesheet -->
  <link href="lib/animate/animate.min.css" rel="stylesheet" />
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

  <!-- Customized Bootstrap Stylesheet -->
  <link href="css/style.css" rel="stylesheet" />
  <meta charset="utf-8" />
  <title>Innov AI Tienda ‚Äî Pagar</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Finaliza tu compra en Innov AI Tienda. Servicios digitales con entrega inmediata y soporte 24/7 por WhatsApp." />
  <meta name="keywords" content="Innov AI Tienda, checkout, pagar, compra, servicios digitales, Per√∫, ChatGPT Plus, Netflix" />

  <link href="img/favicon.ico" rel="icon" />

  <!-- Fonts (c√≥mico como el carrito) -->
  <link rel="preconnect" href="https://fonts.gstatic.com" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&family=Comic+Neue:wght@400;700&family=Bangers&display=swap" rel="stylesheet" />

  <!-- Font Awesome -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet" />

  <!-- Libraries -->
  <link href="lib/animate/animate.min.css" rel="stylesheet" />
  <link href="lib/owlcarousel/assets/owl.carousel.min.css" rel="stylesheet" />

  <!-- Bootstrap template stylesheet -->
  <link href="css/style.css" rel="stylesheet" />

  <style>
    :root{
      --brand-primary:#0d6efd;
      --brand-secondary:#6c757d;

      --sticky-offset:110px;
      --toast-bg:rgba(0,0,0,.86);
      --toast-fg:#fff;

      --wa-size:64px;
      --wa-bg:#25D366;
      --wa-fg:#fff;
      --wa-shadow:0 10px 22px rgba(0,0,0,.28);
      --wa-attention:3.2s;
    }
    @media (min-width: 992px){
      :root{ --sticky-offset:180px; }
    }
    @media (prefers-reduced-motion: reduce){
      :root{ --wa-attention:0s; }
      *{ animation-duration:.01ms !important; animation-iteration-count:1 !important; transition-duration:.01ms !important; scroll-behavior:auto !important; }
    }

    /* Comic skin */
    body{
      font-family:'Comic Neue','Roboto',sans-serif;
      font-size:0.95rem;
      background:
        radial-gradient(circle at 10px 10px, rgba(0,0,0,.04) 2px, transparent 2.2px) 0 0/22px 22px,
        #fff;
    }
    h1,h2,h3,.h1,.h2,.h3{
      font-family:'Bangers','Comic Neue',cursive;
      letter-spacing:.6px;
    }

    /* Header sticky */
    .site-header.sticky-top{ z-index:1045; box-shadow:0 2px 8px rgba(0,0,0,.15); }

    /* Buttons / inputs (c√≥mico) */
    .btn, .custom-select, .form-control{ border-width:2px; }
    .btn{ box-shadow:3px 3px 0 rgba(0,0,0,.20); }
    .btn:active{ transform:translate(2px,2px); box-shadow:1px 1px 0 rgba(0,0,0,.20); }

    /* Steps */
    .steps{
      display:flex;
      flex-wrap:wrap;
      gap:.5rem;
      align-items:center;
      padding:.65rem .9rem;
      background:#fff;
      border:2px solid rgba(0,0,0,.12);
      border-radius:16px;
      box-shadow:6px 6px 0 rgba(0,0,0,.06);
      margin-bottom:1rem;
    }
    .step-pill{
      display:inline-flex;
      align-items:center;
      gap:.5rem;
      padding:.3rem .7rem;
      border-radius:999px;
      border:2px dashed rgba(0,0,0,.18);
      background:#fff;
      font-weight:900;
      font-size:13px;
      box-shadow:4px 4px 0 rgba(0,0,0,.06);
    }
    .step-pill.active{
      border-style:solid;
      background:rgba(13,110,253,.12);
    }

    /* Cards */
    .comic-card{
      background:#fff;
      border:2px solid rgba(0,0,0,.12);
      border-radius:16px;
      box-shadow:7px 7px 0 rgba(0,0,0,.08);
      overflow:hidden;
    }
    .comic-card .card-head{
      padding:.75rem .9rem;
      background:rgba(13,110,253,.10);
      border-bottom:2px solid rgba(0,0,0,.08);
      font-weight:900;
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.75rem;
      font-size:0.95rem;
    }
    .comic-card .card-body{
      padding:.85rem .95rem;
    }

    /* Sticky right column */
    .sticky-col{
      position: sticky;
      top: calc(var(--sticky-offset) + 10px);
    }
    @media (max-width: 991.98px){
      .sticky-col{ position: static; top:auto; margin-top:1rem; }
    }

    /* Order list */
    .order-list{
      max-height: 260px;
      overflow:auto;
      padding-right: 6px;
    }
    .order-item{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.75rem;
      padding:.45rem 0;
      border-bottom:1px dashed rgba(0,0,0,.16);
    }
    .order-item:last-child{ border-bottom:0; }
    .order-left{
      display:flex;
      align-items:center;
      gap:.6rem;
      min-width:0;
    }
    .order-thumb{
      width:40px; height:40px;
      border-radius:12px;
      border:2px solid rgba(0,0,0,.10);
      box-shadow:3px 3px 0 rgba(0,0,0,.06);
      overflow:hidden;
      background:#fff;
      flex:0 0 auto;
      display:flex;
      align-items:center;
      justify-content:center;
    }
    .order-thumb img{
      width:100%;
      height:100%;
      object-fit:contain;
      padding:6px;
    }
    .order-name{
      font-weight:900;
      line-height:1.1;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
      max-width: 220px;
      font-size:0.95rem;
    }
    .order-qty{
      font-size:11px;
      color:rgba(0,0,0,.55);
      margin-top:2px;
      font-weight:700;
    }

    .sum-row{
      display:flex;
      justify-content:space-between;
      gap:.75rem;
      padding:.3rem 0;
      border-bottom:1px dashed rgba(0,0,0,.16);
      font-size:0.95rem;
    }
    .sum-row:last-child{ border-bottom:0; }
    .sum-total{
      display:flex;
      justify-content:space-between;
      gap:.75rem;
      padding-top:.55rem;
      font-size:1.05rem;
      font-weight:900;
    }

    /* Cup√≥n en checkout */
    .coupon-box{
      padding:.55rem .7rem;
      background:#f8f9fa;
      border-radius:12px;
      border:2px dashed rgba(0,0,0,.14);
      box-shadow:3px 3px 0 rgba(0,0,0,.05);
    }
    .coupon-box label{
      font-weight:900;
      font-size:.86rem;
      margin-bottom:.25rem;
      display:flex;
      align-items:center;
    }
    .coupon-box label i{
      margin-right:.35rem;
    }
    #couponInput{
      font-size:.9rem;
    }
    #discountCodeLabel{
      font-size:.74rem;
      vertical-align:middle;
    }

    /* Payment cards */
    .pay-grid{
      display:grid;
      grid-template-columns: 1fr;
      gap:.55rem;
    }
    .pay-card{
      border:2px solid rgba(0,0,0,.12);
      border-radius:13px;
      background:#fff;
      box-shadow:4px 4px 0 rgba(0,0,0,.06);
      overflow:hidden;
      cursor:pointer;
      transition:transform .12s ease, box-shadow .12s ease, border-color .12s ease, background .12s ease;
      display:block;
    }
    .pay-card:hover{ transform:translateY(-1px); box-shadow:5px 5px 0 rgba(0,0,0,.09); }
    .pay-card input{ display:none; }
    .pay-card .pay-head{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:.75rem;
      padding:.6rem .8rem;
    }
    .pay-card .pay-title{
      font-weight:900;
      display:flex;
      align-items:center;
      gap:.45rem;
      font-size:0.95rem;
    }
    .pay-icons{
      display:inline-flex;
      align-items:center;
      gap:.35rem;
      opacity:.95;
    }
    .pay-icons img{ height:18px; width:auto; display:inline-block; }
    .pay-icons .fab{ font-size:18px; }

    .pay-card .pay-body{
      padding: .55rem .8rem .7rem;
      border-top:1px dashed rgba(0,0,0,.15);
      display:none;
      color:rgba(0,0,0,.75);
      font-size:0.88rem;
    }
    .pay-card.selected{
      border-color: rgba(13,110,253,.55);
      background: rgba(13,110,253,.04);
    }
    .pay-card.selected .pay-body{ display:block; }

    .hint-pill{
      display:inline-flex;
      align-items:center;
      gap:.45rem;
      padding:.35rem .6rem;
      border-radius:999px;
      border:2px dashed rgba(0,0,0,.18);
      background:#fff;
      font-size:12px;
      font-weight:900;
      box-shadow:4px 4px 0 rgba(0,0,0,.06);
      margin-top:.7rem;
    }

    /* Selector de agente WhatsApp (igual idea que antes, m√°s peque√±o) */
    #whatsappAgentSelector{
      gap:.5rem;
    }
    #whatsappAgentSelector .btn{
      position:relative;
      border-radius:14px;
      padding:.35rem .5rem;
      font-size:12px;
      white-space:nowrap;
      display:flex;
      align-items:center;
      justify-content:center;
      box-shadow:3px 3px 0 rgba(0,0,0,.08);
      border:2px solid rgba(0,0,0,.12);
      background:#ffffff;
      transition:
        transform .12s ease,
        box-shadow .12s ease,
        border-color .12s ease,
        background .12s ease,
        color .12s ease;
    }
    #whatsappAgentSelector .agent-emoji{
      margin-right:.35rem;
      font-size:1.1rem;
    }
    #whatsappAgentSelector .btn.active{
      background:#25D366;
      border-color:#1ebe5d;
      color:#fff;
      box-shadow:0 0 0 2px rgba(37,211,102,.25),4px 4px 0 rgba(0,0,0,.18);
      transform:scale(1.03);
    }
    #whatsappAgentSelector .btn:not(.active):hover{
      transform:scale(1.03);
      box-shadow:4px 4px 0 rgba(0,0,0,.12);
      border-color:rgba(0,0,0,.22);
    }
    #whatsappAgentSelector .btn:active{
      transform:scale(0.97) translateY(1px);
      box-shadow:2px 2px 0 rgba(0,0,0,.10);
    }

    /* Toast */
    .toast-mini{
      position:fixed; left:50%; bottom:90px; transform:translateX(-50%) translateY(20px);
      background:var(--toast-bg); color:var(--toast-fg);
      padding:10px 14px; border-radius:12px;
      font-size:14px; z-index:1600; opacity:0;
      transition:opacity .2s, transform .2s;
      display:flex; align-items:center; gap:.5rem;
      max-width:min(92vw,520px);
      box-shadow:10px 10px 0 rgba(0,0,0,.18);
    }
    .toast-mini.show{ opacity:1; transform:translateX(-50%) translateY(0); }

    /* Footer (igual que carrito) */
    .footer-wrap{
      background:
        radial-gradient(circle at 20% 0%, rgba(13,110,253,.22), transparent 55%),
        radial-gradient(circle at 85% 100%, rgba(37,211,102,.16), transparent 55%),
        #0f1115;
    }
    .footer-title{ font-family:'Bangers','Comic Neue',cursive; letter-spacing:.7px; }
    .footer-links a{ color: rgba(255,255,255,.70); text-decoration:none; }
    .footer-links a:hover{ color:#fff; text-decoration: underline; }
    .social-btn{
      width:44px; height:44px;
      display:inline-flex; align-items:center; justify-content:center;
      border-radius:12px;
      border:2px solid rgba(255,255,255,.18);
      background:rgba(255,255,255,.06);
      color:#fff;
      margin-right:.5rem;
      box-shadow:4px 4px 0 rgba(0,0,0,.35);
      transition:transform .15s, background .15s, border-color .15s;
    }
    .social-btn:hover{
      transform:translateY(-2px) rotate(-1deg);
      background:rgba(13,110,253,.22);
      border-color:rgba(255,255,255,.30);
      color:#fff;
      text-decoration:none;
    }
    .social-btn i{ font-size:18px; }
    .tiktok-svg{ width:18px; height:18px; fill: currentColor; display:block; }

    /* WhatsApp FABs (2) */
    .whatsapp-fab,
    .whatsapp-fab-2{
      position:fixed; right:18px; width:var(--wa-size); height:var(--wa-size);
      border-radius:50%; background:var(--wa-bg); color:var(--wa-fg);
      display:flex; align-items:center; justify-content:center;
      box-shadow:var(--wa-shadow); z-index:1200; transition:transform .18s, filter .18s;
      isolation:isolate;
      animation:float-y 5.4s ease-in-out infinite;
    }
    .whatsapp-fab{ bottom:18px; }
    .whatsapp-fab-2{ bottom:98px; }
    .whatsapp-fab i, .whatsapp-fab-2 i{ font-size:calc(var(--wa-size)*.45); line-height:1; }
    .whatsapp-fab:hover, .whatsapp-fab-2:hover{ transform:translateY(-3px); filter:saturate(1.08) brightness(1.04); }
    .whatsapp-fab::after, .whatsapp-fab-2::after{
      content:""; position:absolute; inset:-10px; border-radius:inherit;
      box-shadow:0 0 0 0 rgba(37,211,102,.30);
      animation:wa-pulse var(--wa-attention) infinite ease-out; z-index:-1;
    }
    @keyframes wa-pulse{
      0%{ box-shadow:0 0 0 0 rgba(37,211,102,.33); }
      70%{ box-shadow:0 0 0 20px rgba(37,211,102,0); }
      100%{ box-shadow:0 0 0 0 rgba(37,211,102,0); }
    }
    .whatsapp-badge{
      position:absolute; top:-4px; right:-2px; min-width:18px; height:18px; padding:0 4px;
      border-radius:10px; background:#ff3b30; color:#fff; font-size:11px; font-weight:900;
      display:inline-flex; align-items:center; justify-content:center;
      box-shadow:0 2px 8px rgba(0,0,0,.25);
      animation:pulse 1.6s infinite;
    }
    @keyframes pulse{0%{transform:scale(1)}50%{transform:scale(1.12)}100%{transform:scale(1)}}
    @keyframes float-y{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}

    /* Tiny helper */
    .small-muted{ font-size:.92rem; color:#6c757d; }
    .req{ color:#dc3545; font-weight:900; }

    /* Responsive ajustes */
    @media (max-width: 767.98px){
      body{ font-size:0.9rem; }
      .comic-card{
        box-shadow:5px 5px 0 rgba(0,0,0,.07);
      }
      .comic-card .card-head{
        padding:.6rem .75rem;
        font-size:0.9rem;
      }
      .comic-card .card-body{
        padding:.7rem .75rem;
      }
      .order-name{ max-width:180px; font-size:0.9rem; }
      .order-thumb{ width:36px; height:36px; }
      .sum-total{ font-size:1rem; }
      .pay-card .pay-head{
        padding:.5rem .7rem;
      }
      .pay-card .pay-title{
        font-size:0.9rem;
      }
      .pay-card .pay-body{
        font-size:0.82rem;
      }
      #whatsappAgentSelector .btn{
        font-size:11.5px;
        padding:.3rem .4rem;
      }
      #whatsappAgentSelector .agent-phone{
        display:none;
      }
      .coupon-box{
        padding:.45rem .55rem;
        margin-top:.2rem;
      }
    }
    @media (max-width: 575.98px){
      .steps{ padding:.5rem .65rem; }
      .step-pill{ font-size:12px; padding:.25rem .6rem; }
      .order-list{ max-height:220px; }
    }
  </style>
</head>

<body>

  <!-- ===== HEADER (mismo que carrito) ===== -->
  <header class="site-header sticky-top">
    <div class="container-fluid">
      <div class="row bg-secondary py-1 px-xl-5">
        <div class="col-lg-6 d-none d-lg-block">
          <div class="d-inline-flex align-items-center h-100">
            <a class="text-body mr-3" href="acerca.html">Acerca de</a>
            <a class="text-body mr-3" href="contact.html">Contacto</a>
            <a class="text-body mr-3" href="ayuda.html">Ayuda</a>
            <a class="text-body mr-3" href="faq.html">Preguntas frecuentes</a>
          </div>
        </div>

        <div class="col-lg-6 text-center text-lg-right">
          <div class="d-inline-flex align-items-center">
            <div class="btn-group">
              <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">Mi cuenta</button>
              <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="login.html">Ingresar</a>
                <a class="dropdown-item" href="register.html">Registrarse</a>
              </div>
            </div>

            <div class="btn-group mx-2">
              <button id="currencyBtn" type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">Soles</button>
              <div class="dropdown-menu dropdown-menu-right">
                <button class="dropdown-item js-set-currency" data-currency="PEN" type="button">Soles</button>
                <button class="dropdown-item js-set-currency" data-currency="USD" type="button">USD</button>
              </div>
            </div>

            <div class="btn-group">
              <button type="button" class="btn btn-sm btn-light dropdown-toggle" data-toggle="dropdown">ES</button>
              <div class="dropdown-menu dropdown-menu-right">
                <a class="dropdown-item" href="?lang=en">EN</a>
              </div>
            </div>
          </div>

          <div class="d-inline-flex align-items-center d-block d-lg-none">
            <a href="favoritos.html" class="btn px-0 ml-2" aria-label="Favoritos">
              <i class="fas fa-heart text-dark"></i>
              <span class="badge text-dark border border-dark rounded-circle" style="padding-bottom:2px;">0</span>
            </a>
            <a href="cart.html" class="btn px-0 ml-2" aria-label="Carrito">
              <i class="fas fa-shopping-cart text-dark"></i>
              <span id="headerCartBadgeSm" class="badge text-dark border border-dark rounded-circle" style="padding-bottom:2px;">0</span>
            </a>
          </div>
        </div>
      </div>

      <div class="row align-items-center bg-light py-3 px-xl-5 d-none d-lg-flex">
        <div class="col-lg-4">
          <a href="index.html" class="text-decoration-none">
            <span class="h1 text-uppercase text-primary bg-dark px-2">INNOV</span>
            <span class="h1 text-uppercase text-dark bg-primary px-2 ml-n1">TIENDA</span>
          </a>
        </div>

        <div class="col-lg-4 col-6 text-left">
          <form action="buscar.html">
            <div class="input-group">
              <input type="text" class="form-control" placeholder="Buscar productos" aria-label="Buscar productos" />
              <div class="input-group-append">
                <button class="input-group-text bg-transparent text-primary" aria-label="Buscar" type="submit">
                  <i class="fa fa-search"></i>
                </button>
              </div>
            </div>
          </form>
        </div>

        <div class="col-lg-4 col-6 text-right">
          <p class="m-0">Servicio al cliente</p>
          <h5 class="m-0"><a href="tel:+51991564053" class="text-dark">+51 991564053</a></h5>
        </div>
      </div>
    </div>

    <div class="container-fluid bg-dark">
      <div class="row px-xl-5">
        <div class="col-lg-3 d-none d-lg-block">
          <a class="btn d-flex align-items-center justify-content-between bg-primary w-100" data-toggle="collapse" href="#navbar-vertical" style="height:65px;padding:0 30px;">
            <h6 class="text-dark m-0"><i class="fa fa-bars mr-2"></i>Categor√≠as</h6>
            <i class="fa fa-angle-down text-dark"></i>
          </a>
          <nav class="collapse position-absolute navbar navbar-vertical navbar-light align-items-start p-0 bg-light" id="navbar-vertical" style="width:calc(100% - 30px);z-index:999;">
            <div class="navbar-nav w-100">
              <a href="shop.html" class="nav-item nav-link"><i class="fas fa-robot mr-2"></i>IA</a>
              <a href="shop.html" class="nav-item nav-link"><i class="fas fa-tv mr-2"></i>Streaming</a>
              <a href="shop.html" class="nav-item nav-link"><i class="fas fa-film mr-2"></i>Edici√≥n / Video</a>
              <a href="shop.html" class="nav-item nav-link"><i class="fas fa-cubes mr-2"></i>Herramientas</a>
            </div>
          </nav>
        </div>

        <div class="col-lg-9">
          <nav class="navbar navbar-expand-lg bg-dark navbar-dark py-3 py-lg-0 px-0">
            <a href="index.html" class="text-decoration-none d-block d-lg-none">
              <span class="h1 text-uppercase text-dark bg-light px-2">INNOV</span>
              <span class="h1 text-uppercase text-light bg-primary px-2 ml-n1">TIENDA</span>
            </a>
            <button type="button" class="navbar-toggler" data-toggle="collapse" data-target="#navbarCollapse">
              <span class="navbar-toggler-icon"></span>
            </button>

            <div class="collapse navbar-collapse justify-content-between" id="navbarCollapse">
              <div class="navbar-nav mr-auto py-0">
                <a href="index.html" class="nav-item nav-link">Inicio</a>
                <a href="shop.html" class="nav-item nav-link">Tienda</a>
                <div class="nav-item dropdown">
                  <a href="#" class="nav-link dropdown-toggle active" data-toggle="dropdown">P√°ginas <i class="fa fa-angle-down mt-1"></i></a>
                  <div class="dropdown-menu bg-primary rounded-0 border-0 m-0">
                    <a href="cart.html" class="dropdown-item">Carrito</a>
                    <a href="checkout.html" class="dropdown-item active">Pagar</a>
                  </div>
                </div>
                <a href="contact.html" class="nav-item nav-link">Contacto</a>
              </div>

              <div class="navbar-nav ml-auto py-0 d-none d-lg-block">
                <a href="favoritos.html" class="btn px-0" aria-label="Favoritos">
                  <i class="fas fa-heart text-primary"></i>
                  <span class="badge text-secondary border border-secondary rounded-circle" style="padding-bottom:2px;">0</span>
                </a>
                <a href="cart.html" class="btn px-0 ml-3" aria-label="Carrito">
                  <i class="fas fa-shopping-cart text-primary"></i>
                  <span id="headerCartBadge" class="badge text-secondary border border-secondary rounded-circle" style="padding-bottom:2px;">0</span>
                </a>
              </div>
            </div>
          </nav>
        </div>
      </div>
    </div>
  </header>
  <!-- ===== /HEADER ===== -->

  <!-- Breadcrumb -->
  <div class="container-fluid">
    <div class="row px-xl-5">
      <div class="col-12">
        <nav class="breadcrumb bg-light mb-30">
          <a class="breadcrumb-item text-dark" href="index.html">Inicio</a>
          <a class="breadcrumb-item text-dark" href="shop.html">Tienda</a>
          <span class="breadcrumb-item active">Pagar</span>
        </nav>
      </div>
    </div>
  </div>

  <!-- Content -->
  <div class="container-fluid">
    <div class="row px-xl-5">

      <div class="col-12">
        <div class="steps">
          <span class="step-pill"><i class="fa fa-shopping-cart"></i> 1) Carrito</span>
          <span class="step-pill active"><i class="fa fa-credit-card"></i> 2) Pagar</span>
          <span class="step-pill"><i class="fab fa-whatsapp"></i> 3) Confirmaci√≥n</span>

          <span class="ml-auto small-muted">
            <i class="fa fa-shield-alt mr-1"></i>
            Compra r√°pida ‚Ä¢ Entrega digital
          </span>
        </div>
      </div>

      <!-- LEFT: Billing -->
      <div class="col-lg-8 mb-4">
        <div class="comic-card">
          <div class="card-head">
            <span>üßæ Datos de facturaci√≥n</span>
            <span class="small-muted">Campos con <span class="req">*</span> son obligatorios</span>
          </div>

          <div class="card-body">
            <div class="row">
              <div class="col-md-6 form-group">
                <label>Nombres <span class="req">*</span></label>
                <input id="fullName" class="form-control" type="text" placeholder="Tu nombre" autocomplete="name" required>
              </div>

              <div class="col-md-6 form-group">
                <label>Celular (WhatsApp) <span class="req">*</span></label>
                <input id="phone" class="form-control" type="tel" placeholder="+51 999 999 999" autocomplete="tel" required>
                <small class="form-text text-muted">Aqu√≠ te enviamos la entrega y soporte.</small>
              </div>

              <div class="col-md-6 form-group">
                <label>Pa√≠s <span class="req">*</span></label>
                <select id="country" class="custom-select" required>
                  <option value="PE" selected>Per√∫</option>
                  <option value="AR">Argentina</option>
                  <option value="BO">Bolivia</option>
                  <option value="BR">Brasil</option>
                  <option value="CL">Chile</option>
                  <option value="CO">Colombia</option>
                  <option value="CR">Costa Rica</option>
                  <option value="DO">Rep√∫blica Dominicana</option>
                  <option value="EC">Ecuador</option>
                  <option value="SV">El Salvador</option>
                  <option value="GT">Guatemala</option>
                  <option value="HN">Honduras</option>
                  <option value="MX">M√©xico</option>
                  <option value="NI">Nicaragua</option>
                  <option value="PA">Panam√°</option>
                  <option value="PY">Paraguay</option>
                  <option value="PR">Puerto Rico</option>
                  <option value="UY">Uruguay</option>
                  <option value="VE">Venezuela</option>
                  <option value="ES">Espa√±a</option>
                  <option value="US">Estados Unidos</option>
                </select>
              </div>

              <div class="col-md-6 form-group">
                <label>Entrega <span class="req">*</span></label>
                <select id="deliveryMethod" class="custom-select" required>
                  <option value="WhatsApp" selected>WhatsApp (recomendado)</option>
                  <option value="Correo">Correo electr√≥nico</option>
                </select>
                <small class="form-text text-muted">Los accesos se env√≠an tras confirmar el pago.</small>
              </div>

              <div class="col-md-12">
                <div class="custom-control custom-checkbox">
                  <input type="checkbox" class="custom-control-input" id="terms" required>
                  <label class="custom-control-label" for="terms">
                    Acepto los
                    <a href="#" data-toggle="modal" data-target="#termsModal">T√©rminos y Condiciones</a>
                    y la
                    <a href="#" data-toggle="modal" data-target="#privacyModal">Pol√≠tica de Privacidad</a>.
                    <span class="req">*</span>
                  </label>
                </div>

                <div class="hint-pill">
                  <i class="fa fa-info-circle"></i>
                  Solo pedimos nombre, WhatsApp, pa√≠s, entrega y aceptar t√©rminos.
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: Summary + Payment (sticky) -->
      <div class="col-lg-4 mb-4">
        <div class="sticky-col">

          <!-- Summary -->
          <div class="comic-card mb-4">
            <div class="card-head">
              <span>üì¶ Resumen del pedido</span>
              <span class="small-muted" id="itemsCountText">0 items</span>
            </div>

            <div class="card-body">
              <div id="emptyNote" class="small-muted mb-3" style="display:none;">
                Tu carrito est√° vac√≠o. <a href="shop.html">Ir a la tienda</a>
              </div>

              <div id="checkoutProducts" class="order-list">
                <!-- Items din√°micos -->
              </div>

              <!-- ===== CUP√ìN EN CHECKOUT ===== -->
              <div id="couponBox" class="coupon-box mt-2">
                <label for="couponInput">
                  <i class="fa fa-tag"></i> ¬øTienes un cup√≥n?
                </label>
                <div class="input-group input-group-sm">
                  <input
                    type="text"
                    id="couponInput"
                    class="form-control"
                    placeholder="C√≥digo de cup√≥n"
                    autocomplete="off"
                  />
                  <div class="input-group-append">
                    <button class="btn btn-outline-primary" type="button" id="applyCouponBtn">
                      Aplicar
                    </button>
                  </div>
                </div>
                <small id="couponHelp" class="form-text text-muted">
                  V√°lido 1 mes ¬∑ 1 uso por cliente ¬∑ Un solo cup√≥n por pedido.
                </small>
              </div>
              <!-- ===== /CUP√ìN EN CHECKOUT ===== -->

              <div class="mt-3">
                <div class="sum-row">
                  <div><strong>Subtotal</strong></div>
                  <div id="subtotalText">S/ 0.00</div>
                </div>
                <div class="sum-row d-none" id="discountRow">
                  <div>
                    <strong>Descuento</strong>
                    <span id="discountCodeLabel" class="badge badge-success badge-pill ml-1 d-none"></span>
                  </div>
                  <div id="discountText">- S/ 0.00</div>
                </div>
                <div class="sum-row">
                  <div><strong>Env√≠o</strong></div>
                  <div>Digital (gratis)</div>
                </div>
                <div class="sum-total">
                  <div>Total</div>
                  <div id="totalText">S/ 0.00</div>
                </div>
                <small class="d-block mt-2 text-muted">*Montos calculados desde tu carrito (incluye cup√≥n si aplicaste).</small>
              </div>
            </div>
          </div>

          <!-- Payment -->
          <div class="comic-card">
            <div class="card-head">
              <span>üí≥ Pago</span>
              <span class="small-muted">elige uno</span>
            </div>

            <div class="card-body">
              <div class="pay-grid" id="payGrid">

                <label class="pay-card selected" data-method="yape_plin">
                  <input type="radio" name="payment" value="yape_plin" checked>
                  <div class="pay-head">
                    <div class="pay-title">
                      <i class="fas fa-qrcode"></i> Yape / Plin
                    </div>
                    <div class="pay-icons" aria-hidden="true">
                      <img src="img/yape.svg" alt="Yape" onerror="this.style.display='none'">
                      <img src="img/plin.svg" alt="Plin" onerror="this.style.display='none'">
                    </div>
                  </div>
                  <div class="pay-body">
                    <div><strong>C√≥mo pagar:</strong></div>
                    <ol class="mb-2">
                      <li>Te abrimos WhatsApp con tu pedido listo ‚úÖ</li>
                      <li>Te enviamos el QR / n√∫mero de pago</li>
                      <li>Mandas tu comprobante y se entrega r√°pido</li>
                    </ol>
                    <div class="small text-muted">Recomendado para entrega inmediata.</div>
                  </div>
                </label>

                <label class="pay-card" data-method="tarjeta">
                  <input type="radio" name="payment" value="tarjeta">
                  <div class="pay-head">
                    <div class="pay-title">
                      <i class="far fa-credit-card"></i> Tarjeta
                    </div>
                    <div class="pay-icons" aria-hidden="true">
                      <i class="fab fa-cc-visa"></i>
                      <i class="fab fa-cc-mastercard"></i>
                    </div>
                  </div>
                  <div class="pay-body">
                    <div><strong>Tarjeta:</strong></div>
                    <div class="small text-muted">
                      Coordinamos el cobro por mensaje (seg√∫n disponibilidad). Si prefieres, elige Yape/Plin para m√°s rapidez.
                    </div>
                  </div>
                </label>

                <label class="pay-card" data-method="transferencia">
                  <input type="radio" name="payment" value="transferencia">
                  <div class="pay-head">
                    <div class="pay-title">
                      <i class="fas fa-university"></i> Transferencia
                    </div>
                    <div class="pay-icons" aria-hidden="true">
                      <i class="fas fa-exchange-alt"></i>
                    </div>
                  </div>
                  <div class="pay-body">
                    <div><strong>Transferencia:</strong></div>
                    <div class="small text-muted">
                      Te enviamos los datos bancarios por WhatsApp. Luego mandas el comprobante para activar tu servicio.
                    </div>
                  </div>
                </label>

              </div>

              <button class="btn btn-block btn-primary font-weight-bold py-3 mt-3" id="placeOrder">
                <i class="fab fa-whatsapp mr-1"></i> Confirmar pedido por WhatsApp
              </button>
              <div class="small text-muted mt-1">
                Agente seleccionado: <strong id="currentAgentLabel">ü§µ Room</strong>
              </div>
              <div class="d-flex flex-wrap justify-content-between mt-2" id="whatsappAgentSelector">
                <button type="button" class="btn btn-sm btn-light js-select-agent mb-2 flex-fill mr-1"
                        data-agent="ROOM" data-number="51991564053">
                  <span class="agent-emoji">ü§µ</span>
                  <span class="agent-name">Room</span>
                  <span class="agent-phone ml-1">¬∑ +51 991 564 053</span>
                </button>
                <button type="button" class="btn btn-sm btn-light js-select-agent mb-2 flex-fill ml-1"
                        data-agent="ASTRID" data-number="51930264550">
                  <span class="agent-emoji">üë©‚Äç‚úàÔ∏è</span>
                  <span class="agent-name">Ruth</span>
                  <span class="agent-phone ml-1">¬∑ +51 930 264 550</span>
                </button>
              </div>

              <small class="d-block mt-2 text-muted">
                Al confirmar, se abrir√° WhatsApp con tu pedido listo para pagar y coordinar entrega (con el descuento aplicado si usaste cup√≥n).
              </small>

              <button class="btn btn-outline-success btn-block py-3 mt-2 d-none" id="markPaid">
                <i class="fa fa-check-circle mr-1"></i> Ya pagu√© (limpiar carrito)
              </button>

              <div class="hint-pill">
                <i class="fa fa-shield-alt"></i>
                Tu carrito no se guarda (solo sesi√≥n).
              </div>
            </div>
          </div>

        </div>
      </div>

    </div>
  </div>

  <!-- Toast -->
  <div id="toastMini" class="toast-mini" role="status" aria-live="polite" aria-atomic="true">
    <i class="fas fa-check-circle"></i>
    <span id="toastText">Listo</span>
  </div>

  <!-- WhatsApp FABs -->
  <a id="whatsappFab" class="whatsapp-fab"
     href="https://wa.me/51930264550?text=¬°Hola!%20üëã%20Estoy%20en%20la%20p√°gina%20de%20pago%20y%20necesito%20ayuda%20‚úÖ"
     target="_blank" rel="noopener" aria-label="WhatsApp principal">
    <i class="fab fa-whatsapp"></i>
    <span id="whatsappBadge" class="whatsapp-badge" aria-hidden="true">1</span>
  </a>

  <a id="whatsappFab2" class="whatsapp-fab-2"
     href="https://wa.me/51991564053?text=¬°Hola!%20üëã%20Quiero%20finalizar%20mi%20compra%20en%20Innov%20AI%20Tienda%20üõí"
     target="_blank" rel="noopener" aria-label="WhatsApp secundario">
    <i class="fab fa-whatsapp"></i>
    <span id="whatsappBadge2" class="whatsapp-badge" aria-hidden="true">1</span>
  </a>

  <!-- Footer mejorado + redes reales -->
  <footer class="container-fluid footer-wrap text-secondary mt-5 pt-5">
    <div class="row px-xl-5 pt-4">
      <div class="col-lg-4 col-md-12 mb-5 pr-3 pr-xl-5">
        <h4 class="footer-title text-light mb-3">Innov AI Tienda</h4>
        <p class="mb-3" style="color: rgba(255,255,255,.72);">
          Servicios digitales con entrega r√°pida y soporte por WhatsApp.
        </p>

        <div class="p-3" style="background: rgba(255,255,255,.06); border:2px solid rgba(255,255,255,.10); border-radius:14px; box-shadow:6px 6px 0 rgba(0,0,0,.25);">
          <p class="mb-2" style="color: rgba(255,255,255,.72);"><i class="fa fa-map-marker-alt text-primary mr-2"></i>Lima ‚Äî San Isidro ‚Äî Per√∫</p>
          <p class="mb-2"><i class="fa fa-envelope text-primary mr-2"></i><a href="mailto:ainnov611@gmail.com" class="text-light">ainnov611@gmail.com</a></p>
          <p class="mb-0"><i class="fa fa-phone-alt text-primary mr-2"></i><a href="tel:+51991564053" class="text-light">+51 991564053</a></p>

          <hr style="border-color: rgba(255,255,255,.10);" />

          <div>
            <div class="small mb-2" style="color: rgba(255,255,255,.70); font-weight:900;">S√≠guenos</div>

            <a class="social-btn" href="https://www.facebook.com/profile.php?id=61585560703359" target="_blank" rel="noopener" aria-label="Facebook">
              <i class="fab fa-facebook-f"></i>
            </a>

            <a class="social-btn" href="https://www.instagram.com/innov_iaa/" target="_blank" rel="noopener" aria-label="Instagram">
              <i class="fab fa-instagram"></i>
            </a>

            <a class="social-btn" href="https://www.tiktok.com/@innoovia" target="_blank" rel="noopener" aria-label="TikTok">
              <svg class="tiktok-svg" viewBox="0 0 24 24" aria-hidden="true">
                <path d="M17.5 3c.6 2.7 2.6 4.9 5.2 5.6v3.4c-2.2 0-4.2-.7-5.9-2v6.3c0 4-3.2 7.2-7.2 7.2S2.4 20.3 2.4 16.3c0-4 3.2-7.2 7.2-7.2.4 0 .8 0 1.2.1v3.8c-.4-.2-.8-.3-1.2-.3-1.9 0-3.5 1.6-3.5 3.5s1.6 3.5 3.5 3.5 3.5-1.6 3.5-3.5V1.9h3.2c.1.4.2.7.3 1.1z"/>
              </svg>
            </a>
          </div>
        </div>
      </div>

      <div class="col-lg-8 col-md-12">
        <div class="row">
          <div class="col-md-4 mb-5 footer-links">
            <h5 class="footer-title text-light mb-3">Compra r√°pida</h5>
            <div class="d-flex flex-column justify-content-start">
              <a class="mb-2" href="index.html"><i class="fa fa-angle-right mr-2"></i>Inicio</a>
              <a class="mb-2" href="shop.html"><i class="fa fa-angle-right mr-2"></i>Tienda</a>
              <a class="mb-2" href="cart.html"><i class="fa fa-angle-right mr-2"></i>Carrito</a>
              <a class="mb-2" href="checkout.html"><i class="fa fa-angle-right mr-2"></i>Pagar</a>
              <a href="contact.html"><i class="fa fa-angle-right mr-2"></i>Contacto</a>
            </div>
          </div>

          <div class="col-md-4 mb-5 footer-links">
            <h5 class="footer-title text-light mb-3">Soporte</h5>
            <div class="d-flex flex-column justify-content-start">
              <a class="mb-2" href="faq.html"><i class="fa fa-angle-right mr-2"></i>Preguntas frecuentes</a>
              <a class="mb-2" href="ayuda.html"><i class="fa fa-angle-right mr-2"></i>Ayuda</a>
              <a class="mb-2" href="contact.html"><i class="fa fa-angle-right mr-2"></i>Soporte</a>
            </div>
            <div class="mt-3 p-3" style="background: rgba(255,255,255,.06); border:2px dashed rgba(255,255,255,.16); border-radius:14px;">
              <div class="text-light" style="font-weight:900;">Entrega inmediata</div>
              <div style="color: rgba(255,255,255,.70);">Te atendemos r√°pido por WhatsApp.</div>
            </div>
          </div>

          <div class="col-md-4 mb-5">
            <h5 class="footer-title text-light mb-3">Bolet√≠n</h5>
            <p style="color: rgba(255,255,255,.70);">Recibe ofertas y novedades.</p>
            <form action="/suscribirse" method="post">
              <div class="input-group">
                <input type="email" class="form-control" placeholder="Tu correo" required />
                <div class="input-group-append">
                  <button class="btn btn-primary" type="submit">Inscribirse</button>
                </div>
              </div>
            </form>

            <div class="mt-4 p-3" style="background: rgba(255,255,255,.06); border:2px solid rgba(255,255,255,.10); border-radius:14px;">
              <div class="small" style="color: rgba(255,255,255,.70);">
                <strong class="text-light">Tip:</strong> Luego de pagar, toca <strong class="text-light">‚ÄúYa pagu√©‚Äù</strong> para limpiar el carrito.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="row border-top mx-xl-5 py-4" style="border-color: rgba(256, 256, 256, .1) !important;">
      <div class="col-md-6 px-xl-0">
        <p class="mb-md-0 text-center text-md-left" style="color: rgba(255,255,255,.70);">
          &copy; <a class="text-primary" href="#">Innov AI Tienda</a>. Todos los derechos reservados.
        </p>
      </div>
      <div class="col-md-6 px-xl-0 text-center text-md-right">
        <img class="img-fluid" src="img/payments.png" alt="M√©todos de pago" />
      </div>
    </div>
  </footer>

  <!-- Modal: T√©rminos -->
  <div class="modal fade" id="termsModal" tabindex="-1" role="dialog" aria-labelledby="termsTitle" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="termsTitle" class="modal-title">T√©rminos y Condiciones</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <p><strong>1. Identificaci√≥n del proveedor.</strong> Innov AI Tienda ofrece <em>servicios digitales</em> (suscripciones, accesos y cuentas) con entrega digital y soporte por WhatsApp/Correo.</p>
          <p><strong>2. Naturaleza del servicio.</strong> Algunos productos pueden funcionar con <em>perfiles o cuentas por menor</em> y otros como <em>cuentas completas</em>. No estamos afiliados a las marcas mencionadas.</p>
          <p><strong>3. Precios y moneda.</strong> Los precios se muestran en Soles (o USD si se selecciona). Pueden variar hasta confirmar el pedido.</p>
          <p><strong>4. Entrega.</strong> La entrega es digital tras confirmar el pago (WhatsApp o correo).</p>
          <p class="text-muted small">*Plantilla general. Recomendable revisi√≥n legal.</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal: Privacidad -->
  <div class="modal fade" id="privacyModal" tabindex="-1" role="dialog" aria-labelledby="privacyTitle" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <h5 id="privacyTitle" class="modal-title">Pol√≠tica de Privacidad</h5>
          <button type="button" class="close" data-dismiss="modal" aria-label="Cerrar"><span aria-hidden="true">&times;</span></button>
        </div>
        <div class="modal-body">
          <p><strong>Responsable:</strong> Innov AI Tienda. Contacto: <a href="mailto:ainnov611@gmail.com">ainnov611@gmail.com</a>.</p>
          <p><strong>Datos tratados:</strong> nombre, celular (WhatsApp), pa√≠s y detalles del pedido.</p>
          <p><strong>Finalidad:</strong> gestionar compra/entrega y soporte.</p>
          <p class="text-muted small">*Plantilla general. Recomendable revisi√≥n legal.</p>
        </div>
        <div class="modal-footer">
          <button class="btn btn-secondary" data-dismiss="modal">Cerrar</button>
        </div>
      </div>
    </div>
  </div>

  <!-- JS libs -->
  <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/js/bootstrap.bundle.min.js"></script>
  <script src="lib/easing/easing.min.js"></script>
  <script src="lib/owlcarousel/owl.carousel.min.js"></script>
  <script src="js/main.js"></script>

  <script>
    (function(){
      /* ==========================
         CONFIG
         ========================== */
      const FX = 3.70; // 1 USD = 3.70 S/
      const CART_KEY = 'innov_cart_v1';

      // Carrito solo sesi√≥n
      const STORE = sessionStorage;

      // Cupones (misma clave que en cart)
      const APPLIED_COUPON_KEY = 'innov_applied_coupon_v1';
      const USED_COUPONS_KEY  = 'innov_used_coupons_v1';

      // Agentes de WhatsApp (igual que carrito)
      const WA_AGENTS = {
        ROOM:  { name:'Room',  number:'51991564053', emoji:'ü§µ' },
        ASTRID:{ name:'Ruth',number:'51930264550', emoji:'üë©‚Äç‚úàÔ∏è' }
      };

      // Estado
      const state = {
        currency: localStorage.getItem('innov_currency') || 'PEN',
        selectedAgent: localStorage.getItem('innov_wa_agent') || 'ROOM'
      };

      /* ==========================
         HELPERS CART / MONEY
         ========================== */
      function safeParse(s, fallback){
        try{ return JSON.parse(s || ''); }catch(e){ return fallback; }
      }

      function readCart(){
        const cur = safeParse(STORE.getItem(CART_KEY), []);
        if(cur && cur.length) return cur;

        // posible legacy en localStorage
        const legacy = safeParse(localStorage.getItem(CART_KEY), []);
        if(legacy && legacy.length){
          STORE.setItem(CART_KEY, JSON.stringify(legacy));
          localStorage.removeItem(CART_KEY);
          return legacy;
        }
        return [];
      }
      function writeCart(arr){ STORE.setItem(CART_KEY, JSON.stringify(arr || [])); }

      // API global m√≠nima
      window.Cart = window.Cart || {
        items: () => readCart(),
        count: () => readCart().reduce((a,b)=>a+(Number(b.qty)||0),0),
        subtotal: () => readCart().reduce((a,b)=>a + (Number(b.precio||0) * Number(b.qty||1)), 0),
        clear: () => writeCart([])
      };

      function penToUsd(pen){ return pen / FX; }
      function formatMoneyPen(n){ return 'S/ ' + (Number(n)||0).toFixed(2); }
      function formatMoneyUsd(n){ return '$ ' + (Number(n)||0).toFixed(2); }
      function money(pen){
        return (state.currency === 'USD') ? formatMoneyUsd(penToUsd(pen)) : formatMoneyPen(pen);
      }

      function showToast(msg, iconClass){
        const toast = document.getElementById('toastMini');
        const text = document.getElementById('toastText');
        const icon = toast.querySelector('i');
        if(iconClass) icon.className = iconClass;
        text.textContent = msg;
        toast.classList.add('show');
        clearTimeout(showToast._t);
        showToast._t = setTimeout(()=>toast.classList.remove('show'), 1400);
      }

      function syncHeaderBadges(){
        const c = Cart.count();
        const b1 = document.getElementById('headerCartBadge');
        const b2 = document.getElementById('headerCartBadgeSm');
        if(b1) b1.textContent = c;
        if(b2) b2.textContent = c;
      }

      function normalizeImgFallback(img){
        if(!img) return;
        img.dataset.errstep = '0';
        img.addEventListener('error', ()=>{
          const step = Number(img.dataset.errstep || '0') + 1;
          img.dataset.errstep = String(step);
          if(step >= 1){ img.src = 'img/placeholder.jpg'; }
        });
      }

      /* ==========================
         CUPONES (copiado de cart)
         ========================== */

      function isoLocalDate(d){
        const y = d.getFullYear();
        const m = String(d.getMonth()+1).padStart(2,'0');
        const day = String(d.getDate()).padStart(2,'0');
        return `${y}-${m}-${day}`;
      }

      function addMonthsClamped(date, months){
        const y = date.getFullYear();
        const m = date.getMonth();
        const day = date.getDate();
        const targetMonth = m + months;
        const lastDay = new Date(y, targetMonth + 1, 0).getDate();
        const clampedDay = Math.min(day, lastDay);
        return new Date(y, targetMonth, clampedDay);
      }

      const DEFAULT_EXPIRES_ISO = isoLocalDate(addMonthsClamped(new Date(), 1));

      // IMPORTANTE: mismo cat√°logo que en cart.html
      const COUPON_DEFS = [
        // ====== S/ 5 (10 cupones) ======
        { code:'INN5-8GXY12',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-GKVDQK',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-HXFACT',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-JVfsLW',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-KQARZJ',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-KWADSC',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-NFFAD2',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-RY5ESN',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-TX4WEP',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-WYTJG5',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-2K9QWD',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-4X7MPT',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-6H3ZVA',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-7JQ8RC',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-8V2NGL',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-9T5WKB',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-B3Q7XF',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-C9M2HD',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-D6R8YP',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-F4K9SJ',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-G7V3MN',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-H2P8QD',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-J5X7TR',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-K8D2LW',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-L3N9ZA',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-M6C4YF',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-N9H5VK',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-P2W8GS',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-Q7L3BX',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-R4S9CJ',  amountPen:2,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },

        // ====== S/ 5 (10 cupones) ======
        { code:'INN5-8GXYG3',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-GKVMQK',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-HXF4CT',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-JVKFLW',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-KQNKZJ',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-KWTGYC',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-NFFW52',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-RY52TN',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-TX4JQP',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN5-WYTRS5',  amountPen:5,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },

        // ====== S/ 8 (10 cupones) ======
        { code:'INN8-2HHXLX',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-3NBGP7',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-6JR92H',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-9P9ESJ',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-D2ZQAG',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-EBEZD7',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-LW78JK',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-N9TPM6',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-PZH6B5',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN8-SB2J4D',  amountPen:8,  expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },

        // ====== S/ 10 (10 cupones) ======
        { code:'INN10-6WYG4C', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-CHNSDZ', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-JBQXX7', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-MDRQFF', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-R2R8YC', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-XXSELH', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-YNS7Z9', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-YSA6YA', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-Z2Y3HK', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN10-ZJ4YYT', amountPen:10, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },

        // ====== S/ 12 (10 cupones) ======
        { code:'INN12-3S5QCM', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-5ZRD5B', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-6F2AVK', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-D59WNW', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-JFU8UR', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-LKCSGF', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-LX495A', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-NRZPSH', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-UV98H6', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN12-VFRR5M', amountPen:12, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },

        // ====== S/ 15 (10 cupones) ======
        { code:'INN15-3QP5M9', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-FJV3RK', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-JCZ99M', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-JPRRWP', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-MGEFM8', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-NQP92E', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-NWJE83', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-U28E9H', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-YMLR5S', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 },
        { code:'INN15-ZPXFZS', amountPen:15, expiresISO: DEFAULT_EXPIRES_ISO, maxUses:1 }
      ];

      const COUPONS = (function(){
        const map = Object.create(null);
        COUPON_DEFS.forEach(c => { map[String(c.code||'').toUpperCase()] = c; });
        return map;
      })();

      function todayISO(){ return isoLocalDate(new Date()); }
      function isExpired(expiresISO){
        if(!expiresISO) return false;
        return todayISO() > expiresISO;
      }

      function readUsedCoupons(){
        return safeParse(localStorage.getItem(USED_COUPONS_KEY), {});
      }
      function writeUsedCoupons(obj){
        localStorage.setItem(USED_COUPONS_KEY, JSON.stringify(obj || {}));
      }
      function isCouponUsed(code){
        const used = readUsedCoupons();
        return !!used[code];
      }
      function markCouponUsed(code){
        const used = readUsedCoupons();
        used[code] = new Date().toISOString();
        writeUsedCoupons(used);
      }

      function readAppliedCoupon(){
        try{
          const raw = STORE.getItem(APPLIED_COUPON_KEY);
          if(!raw) return null;
          const data = JSON.parse(raw);
          if(data && data.code) return String(data.code).toUpperCase();
          return null;
        }catch(e){ return null; }
      }
      function clearAppliedCoupon(){
        try{ STORE.removeItem(APPLIED_COUPON_KEY); }catch(e){}
      }

      function getDiscountPen(subtotalPen){
        const code = readAppliedCoupon();
        if(!code) return 0;
        const def = COUPONS[code];
        if(!def) return 0;
        if(isExpired(def.expiresISO)) return 0;
        if(isCouponUsed(code)) return 0;

        const raw = Number(def.amountPen || 0);
        return Math.max(0, Math.min(raw, Number(subtotalPen || 0)));
      }

      function consumeCouponIfPresent(){
        const code = readAppliedCoupon();
        if(!code) return;
        const def = COUPONS[code];
        if(!def){ clearAppliedCoupon(); return; }
        if(isExpired(def.expiresISO)){ clearAppliedCoupon(); return; }
        if(isCouponUsed(code)){ clearAppliedCoupon(); return; }

        markCouponUsed(code);
        clearAppliedCoupon();
      }

      /* ==========================
         UI agente WhatsApp
         ========================== */
      function syncAgentUI(){
        const key = (state.selectedAgent && WA_AGENTS[state.selectedAgent]) ? state.selectedAgent : 'ROOM';
        const agent = WA_AGENTS[key];
        const label = document.getElementById('currentAgentLabel');
        if(label) label.textContent = `${agent.emoji} ${agent.name}`;

        document.querySelectorAll('#whatsappAgentSelector .js-select-agent').forEach(btn=>{
          const k = btn.getAttribute('data-agent');
          if(k === key) btn.classList.add('active');
          else btn.classList.remove('active');
        });
      }

      /* ==========================
         Render resumen
         ========================== */
      function renderCheckout(){
        const list = document.getElementById('checkoutProducts');
        const emptyNote = document.getElementById('emptyNote');
        const itemsCountText = document.getElementById('itemsCountText');
        const discountRow = document.getElementById('discountRow');
        const discountText = document.getElementById('discountText');
        const discountCodeLabel = document.getElementById('discountCodeLabel');
        const couponBox = document.getElementById('couponBox');

        if(!list) return;

        list.innerHTML = '';

        const items = Cart.items();
        const count = Cart.count();
        if(itemsCountText){
          itemsCountText.textContent = `${count} item${count===1?'':'s'}`;
        }

        if(emptyNote){
          emptyNote.style.display = items.length === 0 ? 'block' : 'none';
        }

        const subtotalPen = Cart.subtotal();
        const discountPen = getDiscountPen(subtotalPen);
        const couponCode = readAppliedCoupon();
        const totalPen = Math.max(0, subtotalPen - discountPen);

        items.forEach(it=>{
          const qty = Number(it.qty||1);
          const precioPen = Number(it.precio||0);
          const lineTotal = precioPen * qty;

          const row = document.createElement('div');
          row.className = 'order-item';
          row.innerHTML = `
            <div class="order-left">
              <div class="order-thumb">
                <img src="${it.imagen || 'img/placeholder.jpg'}" alt="${(it.nombre||'Producto').replaceAll('"','&quot;')}" loading="lazy" decoding="async">
              </div>
              <div style="min-width:0;">
                <div class="order-name" title="${(it.nombre||'Producto').replaceAll('"','&quot;')}">${it.nombre || 'Producto'}</div>
                <div class="order-qty">x ${qty}</div>
              </div>
            </div>
            <div style="font-weight:900;">${money(lineTotal)}</div>
          `;
          list.appendChild(row);
          normalizeImgFallback(row.querySelector('img'));
        });

        const subtotalNode = document.getElementById('subtotalText');
        const totalNode = document.getElementById('totalText');
        if(subtotalNode){
          subtotalNode.textContent = money(subtotalPen);
        }

        // Mostrar / ocultar fila de descuento + badge con el c√≥digo
        if(discountRow && discountText){
          if(discountPen > 0){
            discountRow.classList.remove('d-none');
            discountText.textContent = '- ' + money(discountPen);

            if(discountCodeLabel){
              discountCodeLabel.textContent = couponCode || '';
              discountCodeLabel.classList.toggle('d-none', !couponCode);
            }

            // Ya hay descuento (viene de un cup√≥n aplicado antes): no permitimos otro cup√≥n
            if(couponBox){
              couponBox.style.display = 'none';
            }
          }else{
            discountRow.classList.add('d-none');
            if(discountCodeLabel){
              discountCodeLabel.classList.add('d-none');
            }
            // No hay descuento: habilitamos el campo de cup√≥n si hay productos
            if(couponBox){
              couponBox.style.display = items.length ? '' : 'none';
            }
          }
        }

        if(totalNode){
          totalNode.textContent = money(totalPen);
        }

        syncHeaderBadges();
      }

      /* ==========================
         Cup√≥n en checkout
         ========================== */
      function handleApplyCoupon(){
        const input = document.getElementById('couponInput');
        if(!input) return;

        const raw = (input.value || '').trim().toUpperCase();
        if(!raw){
          showToast('Ingresa tu c√≥digo de cup√≥n ‚úçÔ∏è','fas fa-tag');
          return;
        }

        const items = Cart.items();
        if(!items.length){
          showToast('Tu carrito est√° vac√≠o üòÖ','fas fa-info-circle');
          return;
        }

        const subtotalPen = Cart.subtotal();

        // Si ya hay un descuento v√°lido (desde el carrito u otro momento), no dejamos aplicar otro
        if(getDiscountPen(subtotalPen) > 0){
          showToast('Ya tienes un cup√≥n aplicado üíö','fas fa-tag');
          return;
        }

        const def = COUPONS[raw];
        if(!def){
          showToast('Cup√≥n no v√°lido üôà','fas fa-exclamation-circle');
          return;
        }

        if(isExpired(def.expiresISO)){
          showToast('Este cup√≥n ya venci√≥ ‚è∞','fas fa-exclamation-circle');
          return;
        }

        if(isCouponUsed(raw)){
          showToast('Este cup√≥n ya fue usado üí≥','fas fa-exclamation-circle');
          return;
        }

        if((Number(def.amountPen)||0) <= 0){
          showToast('Cup√≥n no disponible üòï','fas fa-exclamation-circle');
          return;
        }

        // Guardamos el cup√≥n aplicado en sesi√≥n (mismo esquema que en cart)
        try{
          STORE.setItem(APPLIED_COUPON_KEY, JSON.stringify({ code: raw }));
        }catch(e){}

        renderCheckout();
        showToast('Cup√≥n aplicado üéâ','fas fa-check-circle');
      }

      const applyCouponBtn = document.getElementById('applyCouponBtn');
      if(applyCouponBtn){
        applyCouponBtn.addEventListener('click', handleApplyCoupon);
      }
      const couponInputEl = document.getElementById('couponInput');
      if(couponInputEl){
        couponInputEl.addEventListener('keypress', function(e){
          if(e.key === 'Enter'){
            e.preventDefault();
            handleApplyCoupon();
          }
        });
      }

      /* ==========================
         Payment selection (cards)
         ========================== */
      function syncPayCards(){
        const grid = document.getElementById('payGrid');
        const selected = grid.querySelector('input[name="payment"]:checked');
        grid.querySelectorAll('.pay-card').forEach(card=>{
          const input = card.querySelector('input');
          if(input && selected && input.value === selected.value){
            card.classList.add('selected');
          }else{
            card.classList.remove('selected');
          }
        });
      }
      document.getElementById('payGrid').addEventListener('click', (e)=>{
        const card = e.target.closest('.pay-card');
        if(!card) return;
        const input = card.querySelector('input');
        if(input){
          input.checked = true;
          syncPayCards();
          showToast('M√©todo de pago seleccionado ‚úÖ', 'fas fa-check-circle');
        }
      });

      /* ==========================
         Currency (PEN/USD)
         ========================== */
      const currencyBtn = document.getElementById('currencyBtn');
      function setCurrency(cur){
        state.currency = cur;
        localStorage.setItem('innov_currency', cur);
        currencyBtn.textContent = (cur === 'USD') ? 'USD' : 'Soles';
        renderCheckout();
        showToast('Moneda actualizada üí±', 'fas fa-exchange-alt');
      }
      currencyBtn.textContent = (state.currency === 'USD') ? 'USD' : 'Soles';
      document.querySelectorAll('.js-set-currency').forEach(btn=>{
        btn.addEventListener('click', ()=> setCurrency(btn.getAttribute('data-currency')));
      });

      /* ==========================
         Selector de agente
         ========================== */
      document.querySelectorAll('#whatsappAgentSelector .js-select-agent').forEach(btn=>{
        btn.addEventListener('click', ()=>{
          const key = btn.getAttribute('data-agent');
          if(!WA_AGENTS[key]) return;
          state.selectedAgent = key;
          try{ localStorage.setItem('innov_wa_agent', key); }catch(e){}
          syncAgentUI();
        });
      });

      /* ==========================
         Confirm order -> WhatsApp
         ========================== */
      function orderId(){
        const d = new Date();
        const y = d.getFullYear();
        const m = String(d.getMonth()+1).padStart(2,'0');
        const day = String(d.getDate()).padStart(2,'0');
        const r = Math.random().toString(36).slice(2,6).toUpperCase();
        return `INN-${y}${m}${day}-${r}`;
      }

      const placeBtn = document.getElementById('placeOrder');
      const markPaidBtn = document.getElementById('markPaid');

      placeBtn.addEventListener('click', function(ev){
        ev.preventDefault();

        const items = Cart.items();
        if(items.length === 0){
          showToast('Carrito vac√≠o üòÖ', 'fas fa-info-circle');
          setTimeout(()=> window.location.href='shop.html', 350);
          return;
        }

        const fullName = (document.getElementById('fullName').value||'').trim();
        const phone     = (document.getElementById('phone').value||'').trim();
        const delivery  = document.getElementById('deliveryMethod').value;
        const country   = document.getElementById('country').value;
        const termsOk   = document.getElementById('terms').checked;
        const payMethod = document.querySelector('input[name="payment"]:checked')?.value || 'yape_plin';

        if(!fullName || !phone || !country){
          showToast('Completa nombre, WhatsApp y pa√≠s ‚úçÔ∏è', 'fas fa-exclamation-circle');
          return;
        }
        if(!termsOk){
          showToast('Acepta T√©rminos y Privacidad ‚úÖ', 'fas fa-exclamation-circle');
          return;
        }

        const oid = orderId();

        const subtotalPen = Cart.subtotal();
        const discountPen = getDiscountPen(subtotalPen);
        const totalPen = Math.max(0, subtotalPen - discountPen);
        const couponCode = readAppliedCoupon();

        const payLabelMap = {
          yape_plin: 'Yape / Plin',
          tarjeta: 'Tarjeta (Visa/Mastercard)',
          transferencia: 'Transferencia bancaria'
        };

        const agentKey = (state.selectedAgent && WA_AGENTS[state.selectedAgent]) ? state.selectedAgent : 'ROOM';
        const agent = WA_AGENTS[agentKey];

        const lines = [];
        lines.push(`Hola, quiero completar mi compra en *Innov AI Tienda* üõí`);
        lines.push(`Pedido: *${oid}*`);
        lines.push('');
        lines.push(`Agente: *${agent.name}* ¬∑ +${agent.number}`);
        lines.push(`Moneda en pantalla: *${state.currency === 'USD' ? 'USD' : 'Soles (PEN)'}*`);
        lines.push('');

        if(couponCode && discountPen > 0){
          lines.push('*Cup√≥n:*');
          lines.push(`- C√≥digo: ${couponCode}`);
          lines.push(`- Descuento aplicado: -${formatMoneyPen(discountPen)}`);
          lines.push('');
        }

        lines.push('*Productos:*');
        items.forEach(p=>{
          const qty = Number(p.qty||1);
          const precioPen = Number(p.precio||0);
          lines.push(`- ${p.nombre} x${qty} (Total: ${formatMoneyPen(precioPen*qty)})`);
        });
        lines.push('');
        lines.push(`Subtotal: ${formatMoneyPen(subtotalPen)}`);
        if(discountPen > 0) lines.push(`Descuento: -${formatMoneyPen(discountPen)}`);
        lines.push(`Total: ${formatMoneyPen(totalPen)}`);
        lines.push('');
        lines.push(`*Pago:* ${payLabelMap[payMethod] || payMethod}`);
        lines.push(`*Entrega:* ${delivery}`);
        lines.push(`*Pa√≠s:* ${country}`);
        lines.push('');
        lines.push('*Datos:*');
        lines.push(`- Nombre: ${fullName}`);
        lines.push(`- WhatsApp: ${phone}`);
        lines.push('');
        lines.push('Gracias ‚úÖ');

        const url = `https://wa.me/${agent.number}?text=${encodeURIComponent(lines.join('\n'))}`;
        window.open(url, '_blank', 'noopener');

        if(discountPen > 0 && couponCode){
          consumeCouponIfPresent();
        }

        markPaidBtn.classList.remove('d-none');
        showToast('WhatsApp abierto ‚úÖ Env√≠anos el comprobante', 'fab fa-whatsapp');
      });

      markPaidBtn.addEventListener('click', function(ev){
        ev.preventDefault();
        consumeCouponIfPresent();
        Cart.clear();
        renderCheckout();
        syncHeaderBadges();
        showToast('Listo ‚úÖ Carrito limpiado', 'fas fa-check-circle');
        setTimeout(()=> window.location.href='cart.html?paid=1', 500);
      });

      /* ==========================
         WhatsApp badges hide
         ========================== */
      (function(){
        var badge1 = document.getElementById('whatsappBadge');
        var badge2 = document.getElementById('whatsappBadge2');
        try {
          if (sessionStorage.getItem('waBadgeHidden')==='1') badge1 && (badge1.style.display='none');
          if (sessionStorage.getItem('waBadge2Hidden')==='1') badge2 && (badge2.style.display='none');
        } catch(e){}
        document.getElementById('whatsappFab')?.addEventListener('click', function(){
          if(badge1) badge1.style.display='none';
          try { sessionStorage.setItem('waBadgeHidden','1'); } catch(e){}
        });
        document.getElementById('whatsappFab2')?.addEventListener('click', function(){
          if(badge2) badge2.style.display='none';
          try { sessionStorage.setItem('waBadge2Hidden','1'); } catch(e){}
        });
      })();

      /* ==========================
         Init
         ========================== */
      syncPayCards();
      renderCheckout();
      syncHeaderBadges();
      syncAgentUI();

      // Si cambia la moneda en otra p√°gina, refresca el checkout
      window.addEventListener('storage', function(e){
        if(e.key === 'innov_currency'){
          state.currency = localStorage.getItem('innov_currency') || 'PEN';
          currencyBtn.textContent = (state.currency === 'USD') ? 'USD' : 'Soles';
          renderCheckout();
        }
      });
    })();
  </script>
</body>
</html>




